package walgreens.ecom.batch.automation.library.checkout;

import java.text.DecimalFormat;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import javax.mail.Flags.Flag;
import org.apache.commons.lang.StringUtils;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.events.EventFiringWebDriver;
import org.openqa.selenium.support.ui.Select;
import com.gargoylesoftware.htmlunit.javascript.host.Text;
import walgreens.ecom.batch.automation.library.common.CommonLibrary;
import walgreens.ecom.batch.framework.EcommTestRunner;
import walgreens.ecom.batch.framework.common.beans.OrderBean;
import walgreens.ecom.batch.framework.common.beans.ProductBean;
import walgreens.ecom.batch.framework.common.beans.ScenarioBean;
import walgreens.ecom.batch.framework.common.beans.StepBean;
import walgreens.ecom.batch.framework.common.dao.TestDataDBManager;

public class CheckoutLibrary extends CommonLibrary {

    /**
     ************************************************************* 
     * @Purpose - Method to Remove all products from shopping cart
     * @author - Chezhiyan. E
     * @Created - 25-Nov-2011
     * @Modified By - Siva
     * @Modified Date - 01-APR-2013
     ************************************************************* 
     */
    public static void removeItemsFromShoppingCart(EventFiringWebDriver browser, StepBean stepBean) {
	String status = PASS;
	String NoItemsInCart_TEXT = "//*[contains(text(), 'no items in your cart')]~XPATH";
	String cartURL = "store/checkout/cart.jsp";
	String ShoppingCartHeader_ELM = "//*[contains(text(),'Shopping Cart')]~XPATH";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    String cartUrl = EcommTestRunner.config.getString("walgreensURL") + cartURL;
	    getUrl(browser, cartUrl);
	    if (!isElementPresentVerification(NoItemsInCart_TEXT, browser)) {
		List<WebElement> cartItems = getElementsListByLinkText("Remove", browser);
		int cartItemsSize = cartItems.size();
		while (cartItemsSize > 0) {
		    cartItems.get(0).click();
		    // Validating Shopping Cart Header to make sure page is
		    // loaded.
		    if (!isElementPresentVerification(ShoppingCartHeader_ELM, browser)) {
			messagesMap.put("Shopping Cart", "Cart is not Loaded after removing one item");
			status = WARNING;
		    }
		    // reset it
		    cartItems = null;
		    cartItems = getElementsListByLinkText("Remove", browser);
		    if (cartItems != null) {
			cartItemsSize = cartItems.size();
		    }
		}
		if (!isElementPresentVerification(NoItemsInCart_TEXT, browser)) {
		    throw new Exception("Not able to find No Itmes in Cart Message");
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to Navigate to Shopping cart Page using View Your
     *          Cart(Global Link) link
     * @author - Imran Aslam
     * @Created - March 23rd, 2012
     * @Modified By - Siva
     * @Modified Date -25-JULY-2013
     ************************************************************* 
     */
    public static void goToShoppingCart(EventFiringWebDriver browser, StepBean stepBean) {
	String ViewYourCart_LNK = "//p[@class='cart_link_pos']/a~XPATH";
	String ViewYourCart_New_LNK = "//a[contains(text(),'Checkout')]~XPATH";
	String ShoppingCart_Heading = "//*[contains(text(),'Shopping Cart')]~XPATH";
	String status = PASS;
	boolean isOnCartPage = false;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    if (isElementPresentVerification(ViewYourCart_LNK, browser)) {
		getElementByProperty(ViewYourCart_LNK, browser).sendKeys(Keys.RETURN);
	    } else {
		if (!isElementPresentVerifyClick(ViewYourCart_New_LNK, browser)) {
		    throw new Exception("Not able to click on View Your Cart Link");
		}
	    }
	    isOnCartPage = isElementPresentVerification(ShoppingCart_Heading, browser);
	    if (!isOnCartPage) {

		// ----------------------------------------------------------------------------------------------------
		// Ram - 10/14/14 - Added to make sure it works fine in new FF -
		// press enter

		getElementByProperty(ViewYourCart_New_LNK, browser).sendKeys(Keys.RETURN);
		isOnCartPage = isElementPresentVerification(ShoppingCart_Heading, browser);
		if (!isOnCartPage) {
		    messagesMap.put("Shopping Cart", "Not able to Navigate to Shopping Cart through mini cart.");
		    status = WARNING;
		}
		// ----------------------------------------------------------------------------------------------------
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to click clicking Proceed to Checkout button in
     *          Shopping Cart Page and verifying the Destiantion Page
     * @author - Imran Aslam
     * @Created - March 23rd, 2012
     * @Modified By - Siva
     * @Modified Date -13-Feb-2013
     ************************************************************* 
     */
    public static void proceedToCheckout(EventFiringWebDriver browser, ScenarioBean scenario, StepBean stepBean, Map<String, List<String>> dataMap) {
	String ProceedToCheckout_BTN = "//input[@title='Proceed to checkout' or @title='Checkout' or @value='Proceed to checkout']~XPATH";
	// String ProceedToCheckout_BTN = "input[title*='Checkout']~CSS";
	String ShippingInformation_Heading = "//*[contains(text(),'Shipping Information') or contains(text(),'Ship  address') or contains(text(),'Ship')]~XPATH";
	String DoctorInformation_Heading = "//h1[contains(text(),'Patient and Doctor Details')]~XPATH";
	String SigninorRegister_Heading = "//h1[contains(text(),'Sign In or Register')]~XPATH";
	String PickupDetailsHeader = "//*[contains(text(),'Pickup details')]~XPATH";
	String PickupLocationHeader = "//*[contains(text(),'Pickup Location') or contains(text(),'Pickup details')]~XPATH";
	String DelvieryAddressPageHeader_ELM = "//p[contains(text(),'Delivery address')]~XPATH";
	String SoldorShiptoPageHeader_ELM = "//h2[contains(text(),'Checking Out: Specifying Sold To / Ship To')]~XPATH";
	String expectedTargetPage = null;
	String status = PASS;
	boolean isOnExpectedTargetPage = false;
	Map<String, String> messagesMap = null;
	OrderBean orderBean = null;
	List<ProductBean> productsList = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }

	    // ////////// Start of PsuedoCode /////////////////

	    // Start - This will keep track of all the orders in the framework
	    if (orderBeansMap == null) {
		orderBeansMap = new HashMap<String, OrderBean>();
	    }
	    // End - This will keep track of all the orders in the framework

	    if (scenario.getOrderBean() == null) {
		orderBean = new OrderBean();
		orderBean.setScenarioId(scenario.getScenarioNumber());
		scenario.setOrderBean(orderBean);
	    } else {
		orderBean = scenario.getOrderBean();
	    }

	    /*
	     * if (orderBean.getProductsMap() == null) { productsList = new
	     * ArrayList<ProductBean>(); orderBean.setProductsMap(productsList);
	     * } else { productsMap = orderBean.getProductsMap(); }
	     * 
	     * // Create the following beans in a loop for all the items in the
	     * // cart
	     * 
	     * // Start of the loop ProductBean productBean = new ProductBean();
	     * productBean.setProductName("Shampoo");
	     * productBean.setProductId("123456");
	     * productBean.setProductQuantity("3");
	     * productBean.setProductDeliveryOption("localDelivery"); //
	     * Optional // productBean.setProductType("CL");
	     * productBean.setProductTotalPrice("25.99");
	     * 
	     * productsMap.put(productBean.getProductId(), productBean);
	     */
	    // End of the loop

	    // Start - This will keep track of all the orders in the framework
	    orderBeansMap.put(scenario.getScenarioNumber(), orderBean);
	    // End - This will keep track of all the orders in the framework

	    // ////////// End of PsuedoCode /////////////////

	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		expectedTargetPage = dataMap.get("ExpectedTargetPage").get(i);

		if (isElementPresentVerification(ProceedToCheckout_BTN, browser)) {
		    getElementByProperty(ProceedToCheckout_BTN, browser).click();
		} else {
		    throw new Exception("Not able to click on Proceed to Checkout Button. ");
		}

		if ("Shipping Information".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(ShippingInformation_Heading, browser);
		} else if ("Doctor Information".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(DoctorInformation_Heading, browser);
		} else if ("SigninorRegister".equalsIgnoreCase(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(SigninorRegister_Heading, browser);
		} else if ("PikckUpDetails".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(PickupDetailsHeader, browser);
		} else if ("PickupLocation".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(PickupLocationHeader, browser);
		} else if ("Delivery Address".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(DelvieryAddressPageHeader_ELM, browser);
		} else if ("SoldOrShiptoAddress".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = isElementPresentVerification(SoldorShiptoPageHeader_ELM, browser);
		} else if ("-".equals(expectedTargetPage)) {
		    isOnExpectedTargetPage = true;
		}
		if (!isOnExpectedTargetPage) {
		    status = WARNING;
		    messagesMap.put("ExpectedTargetPage", "Page is not navigated to the Respective Page");
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to click the Sumbit Order Button in Order Review
     *          Page(Old Method)
     * @author - Imran
     * @Created - March 23rd, 2012
     * @Modified By - Siva
     * @Modified Date -08-Nov-12
     ************************************************************* 
     */
    public static void submitOrder(EventFiringWebDriver browser, StepBean stepBean) {
	String SubmitOrder_BTN = "input[title='Submit Order']~CSS";
	String OrderPlacedVerification_Heading = "//p[@class='nopad']/strong[contains(text(),'your order has been placed')]~XPATH";
	String status = PASS;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    if (!isElementPresentVerifyClick(SubmitOrder_BTN, browser)) {
		throw new Exception("Nto able to Click on Submit order Button");
	    }
	    if (isElementPresentVerification(OrderPlacedVerification_Heading, browser)) {
		messagesMap.put("Order Confirmation Page", "Order Placed success message is not displaying");
		status = WARNING;
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to select required option (home address or shipping
     *          address or new shipping address ) from shipping Info Page
     * @author - Imran
     * @Created - Sep-30-2013
     * @Modified By - Ygnash
     * @Modified Date -23-AUG-2013
     ************************************************************* 
     */
    public static void selectShippingOptionFromShippingInfoPage1(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String shippingAddressType = null;
	String Continue_BTN = "//input[@title='Continue' or @title='Continue checkout']~XPATH";
	String ShippingMethod_Heading = "//*[contains(text(),'Ship Method') or contains(text(),'Shipped to you') or contains(text(),'Delivery details')]~XPATH";
	String AddressNotFound_MESSAGE = "//b[contains(text(),'Address Not Found') or contains(text(),'Incomplete Address')]~XPATH";
	String AddressNotFound_TXT = "//p[contains(text(),'We do not recognize the')or contains(text(),'The United States Postal Service')]~XPATH";
	String VerifyYourCounty_Heading = "//*[contains(text(),'Verify your County') or contains(text(),'Verify your county')]~XPATH";
	String VerifyYourAddress_Heading = "//*[contains(text(),'Verify your Shipping Address')]~XPATH";
	String VerifyAddressSelect_BTN = "//input[@type='submit'][@id='select-button']~XPATH";
	String VerifyCountySelect_BTN = "input[value='Select']~CSS";
	String FirstName_TXT = "//input[@id='firstName'  or @id='newShippingFirstName']~XPATH";
	String LastName_TXT = "//input[@id='newShippingLastName'  or @id='lastName']~XPATH";
	String StreetAddress_TXT = "//input[@id='streetAddress1'  or @id='address' or @id='streetAddress' or @id='shipAddress']~XPATH";
	String City_TXT = "//input[@id='newShippingCity'  or @id='city' or @id='editShipCity']~XPATH";
	String ShippingState_LST = "//select[@id='newShippingState'  or @id='state' or @id='editShipState']~XPATH";
	String ZipCode_TXT = "//input[@id='newShippingPostalCode'  or @id='zip' or @id='editZipCode']~XPATH";
	String EmailAddress_TXT = "//input[@id='newShippingEmailId'  or @id='email1' or @id='emailAddress']~XPATH";
	String PhoneNumber_TXT = "//input[@id='newShippingPhoneNumber'  or @id='phone' or @id='phoneNumber']~XPATH";
	String SaveasPreffered_CHK = "input#editShipSaveAsPrefAddr~CSS"; // SIMEON
	// -
	// 8/29/13
	// -
	// Fixed
	String OffersbyEmail_CHECK = "//input[@id='optIn']~XPATH";
	String UnionTerriotoryAddressError_ELM = "//div[@id='leftNavShippingInfo']/form[@name='shipinfo']//div[contains(@class, 'error')]//p[contains(text(),'At this time')]~XPATH";
	String BacktoAddress_LNK = "//a[@title='Back to address']~XPATH";
	String ShipAddress_DIV = "//p[contains(text(),'Shipping Information')]~XPATH"; // SIMEON
	// -
	// 8/29/13
	// -
	// Fixed
	String ChangeAddress_BTN = "//*[@alt='Change address' or @title='Change Address']~XPATH";
	String AddNewAddressBook_BTN = "//input[@title='Add New Address']~XPATH";
	String SaveandSelect_BTN = "input[title='Select and Save']~CSS";
	String EditAddres_BTN = "//input[@title='Edit this address']~XPATH";
	String PrefferedAddressText_ELM = "//div[contains(text(),'Preferred address')]~XPATH";
	String Delete_LNK = "//*[@id='addressCardSection']/div[2]/a[@title='Delete']~XPATH";
	String SelectAddressHome_BTN = "//*[@id='addressCardSection']/div[1]/input~XPATH";
	String SelectAddressShip_BTN = "//*[@id='addressCardSection']/div[2]/input~XPATH";
	String Delete_BTN = "a[title='Delete']~CSS";
	String Close_BTN = "img[title='Close']~CSS";
	String PrepopulatedEmailAddress = null;
	String Ship_Address_Locator = "//div[@id='rightNav']/div[2]~XPATH";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    Map<String, String> sharedProperties = null;
	    sharedProperties = scenarioBean.getSharedStepProperties();
	    if (sharedProperties == null) {
		sharedProperties = new HashMap<String, String>();
		scenarioBean.setSharedStepProperties(sharedProperties);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		shippingAddressType = dataMap.get("ShippingAddressType").get(i);
		if ("homeaddress".equalsIgnoreCase(shippingAddressType)) {
		    // New AB changes ----HASAN--24/Jul/2013
		    // change address check for PSC only in cart scenario
		    if (isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
			// MOdified for Choosing home address-
			if (isElementPresentVerification(Delete_LNK, browser)) {
			    if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
				throw new Exception("Not able to Select Address Button in Home Address Section");
			    }
			    if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
				throw new Exception("Not able to Click on Change Address Button");
			    }
			    if (!isElementPresentVerifyClick(SelectAddressHome_BTN, browser)) {
				throw new Exception("Not able to Select Address Button in Home Address Section");
			    }
			} else {
			    if (!isElementPresentVerifyClick(Close_BTN, browser)) {
				throw new Exception("Not able to Click on close Button");
			    }
			}
		    }
		} else if ("shippingaddress".equalsIgnoreCase(shippingAddressType)) {
		    // New AB changes ----HASAN--24/Jul/2013
		    if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
			throw new Exception("Not able to Click on Change Address Button");
		    }
		    if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
			throw new Exception("Not able to Select Address Button in Shipping Address Section");
		    }
		} else if ("newshippingaddress".equalsIgnoreCase(shippingAddressType) || "Editshippingaddress".equalsIgnoreCase(shippingAddressType)) {
		    if ("Editshippingaddress".equalsIgnoreCase(shippingAddressType)) {
			if (!isElementPresentVerifyClick(EditAddres_BTN, browser)) {
			    throw new Exception("Edit Shipping Address: Not able to click on Edit Address Button from Shipping Information Page.");
			}
		    } else if (isElementPresentVerification(ChangeAddress_BTN, browser)) {
			getElementByProperty(ChangeAddress_BTN, browser).click();
			// Delete one Address
			if (isElementPresentVerification(Delete_LNK, browser)) {
			    getElementByProperty(Delete_LNK, browser).click();
			    Thread.sleep(1000);
			}
			if (isElementPresentVerification(AddNewAddressBook_BTN, browser)) {
			    getElementByProperty(AddNewAddressBook_BTN, browser).click();
			}
		    }
		    if (!"-".equals(dataMap.get("FirstName").get(i))) {
			if (!clearAndEnterText(FirstName_TXT, dataMap.get("FirstName").get(i), browser)) {
			    messagesMap.put("First Name", "Not able to Enter First Name");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("LastName").get(i))) {
			if (!clearAndEnterText(LastName_TXT, dataMap.get("LastName").get(i), browser)) {
			    messagesMap.put("Last Name", "Not able to Enter Last Name.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("StreetAddress").get(i))) {
			if (!clearAndEnterText(StreetAddress_TXT, dataMap.get("StreetAddress").get(i), browser)) {
			    messagesMap.put("StreetAddress", "Not able to Enter Street Address.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("City").get(i))) {
			if (!clearAndEnterText(City_TXT, dataMap.get("City").get(i), browser)) {
			    messagesMap.put("City", "Not able to Enter City.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("State").get(i))) {
			WebElement stateListElement = getElementByProperty(ShippingState_LST, browser);
			if (stateListElement != null) {
			    new Select(stateListElement).selectByIndex(Integer.parseInt(dataMap.get("State").get(i)));
			} else {
			    messagesMap.put("State", "New Shipping Address: Not able to get the new selectBox from Shipping Information Page.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("ZipCode").get(i))) {
			if (!clearAndEnterText(ZipCode_TXT, dataMap.get("ZipCode").get(i), browser)) {
			    messagesMap.put("Zip Code", "Not able to Enter Zip Code.");
			    status = WARNING;
			}
		    }
		    // Checking user is logged in or not. if email address
		    // prepopulated, he is a logged-in user.
		    PrepopulatedEmailAddress = null;
		    if (isElementPresentVerification(EmailAddress_TXT, browser)) {
			PrepopulatedEmailAddress = getElementByProperty(EmailAddress_TXT, browser).getAttribute("value");
		    }
		    if ("yes".equalsIgnoreCase(dataMap.get("SaveShippingAddress").get(i))) {
			/*
			 * WebElement checkBox =
			 * getElementByProperty(SaveasPreffered_CHK, browser);
			 * if (checkBox != null) { checkBox.click(); } else {
			 * messagesMap.put("Save as Preffered CheckBox",
			 * " Not able to click on Save as Preffered CheckBox");
			 * status = WARNING; }
			 */
			if (!checkBoxSelection(browser, SaveasPreffered_CHK, "SELECT")) {
			    messagesMap.put("Save as Preffered CheckBox", " Not able to click on Save as Preffered CheckBox");
			    status = WARNING;
			}
		    }
		    if (dataMap.get("OffersbyEmail") != null) {
			if (dataMap.get("OffersbyEmail").get(0).equalsIgnoreCase("Yes")) {
			    if (!isElementPresentVerifyClick(OffersbyEmail_CHECK, browser)) {
				messagesMap.put("SOffers by Email checkbox", "Not able to click on Offers by Email checkbox");
				status = WARNING;
			    }
			}
		    }
		    if (!"-".equals(dataMap.get("EmailAddress").get(i))) {
			if (!clearAndEnterText(EmailAddress_TXT, dataMap.get("EmailAddress").get(i), browser)) {
			    messagesMap.put("Email Address", "Not able to Enter Email Address.");
			    status = WARNING;
			}
		    }
		    // click on Save and Select only Logged in user
		    if (isElementPresentVerification(SaveandSelect_BTN, browser)) {
			if (!isElementPresentVerifyClick(SaveandSelect_BTN, browser)) {
			    throw new Exception("Not able to Click on Save and Select Button");
			}
		    }
		    if ("yes".equalsIgnoreCase(dataMap.get("SaveShippingAddress").get(i))) {
			if (!isElementPresentVerification(PrefferedAddressText_ELM, browser)) {
			    messagesMap.put("Preffered Addres Message", "Message is missing beside selected address");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("PhoneNumber").get(i))) {
			if (!clearAndEnterText(PhoneNumber_TXT, dataMap.get("PhoneNumber").get(i), browser)) {
			    messagesMap.put("Phone Number", "Not able to Enter Phone Number.");
			    status = WARNING;
			}
		    }
		}
		// click continue Button in General flow. Donot click
		// ContinueButton if it mention explicitely, so it will be
		// useful while validating error Message.
		if (dataMap.get("Continue") == null) {
		    if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
			throw new Exception("Not able to Click on continue Button in Shipping info Page");
		    }
		}
		// Address not found situation
		if (isElementPresentVerification(AddressNotFound_MESSAGE, browser)) {
		    String AddressNotFoundMessage = getTestData("CommonData", "GenaralInfo", "AddressNotFoundMessage", "Message").trim();
		    String AddressNotFound = getElementByProperty(AddressNotFound_TXT, browser).getText().trim();
		    String AddressIncompleteMessage = getTestData("CommonData", "GenaralInfo", "IncompleteAddress", "Message").trim();
		    if (!AddressNotFound.equals(AddressNotFoundMessage) && !AddressNotFound.equals(AddressIncompleteMessage)) {
			messagesMap.put("Address not found message", "address not found message is not matching");
			status = WARNING;
		    }

		    if (isElementPresentVerification(Continue_BTN, browser)) {
			getElementByProperty(Continue_BTN, browser).click();
		    } else {
			throw new Exception("Address Not Found Situation: Not able to click on Continue Button from Shipping Information Page.");
		    }
		}
		if (dataMap.get("ErrorValidation") != null) {
		    if (dataMap.get("ErrorValidation").get(i).equalsIgnoreCase("UnionTerritory")) {
			if (!isElementPresentVerification(UnionTerriotoryAddressError_ELM, browser)) {
			    messagesMap.put("Union Terrotory Address ", "Error Message is not being displayed");
			    status = WARNING;
			}
		    }
		}
		// Verify Your Address Overlay
		if (isElementPresentVerification(VerifyYourAddress_Heading, browser)) {
		    if (!isElementPresentVerifyClick(VerifyAddressSelect_BTN, browser)) {
			throw new Exception("Not able to click on select button in Verify Address Page");
		    }
		}
		// Verify County Back to address validation
		// Modified by Fyrose Apr-10
		if (dataMap.get("CountyBacktoAddress") != null) {
		    if (dataMap.get("CountyBacktoAddress").get(0).equalsIgnoreCase("BacktoAddress")) {
			if (isElementPresentVerification(VerifyYourCounty_Heading, browser)) {
			    if (!isElementPresentVerifyClick(BacktoAddress_LNK, browser)) {
				throw new Exception("Not able to click on Back to address link");
			    }
			    if (!isElementPresentVerification(ShipAddress_DIV, browser)) {
				messagesMap.put("Verify your County ", "Shipping address page is not displayed");
				status = WARNING;
			    }
			} else {
			    messagesMap.put("Verify your County ", "Verify your conty page not displayed");
			    status = WARNING;
			}
		    }
		}
		// Verify Your County page
		if (isElementPresentVerification(VerifyYourCounty_Heading, browser)) {
		    if (!isElementPresentVerifyClick(VerifyCountySelect_BTN, browser)) {
			throw new Exception("Not able to click on select button in Verify County Page");
		    }
		}
		if (dataMap.get("CountyBacktoAddress") != null) {
		    // do Nothing
		} else if ((dataMap.get("ErrorValidation") == null || dataMap.get("ErrorValidation").get(i).equals("-")) && dataMap.get("Continue") == null) {
		    if (!isElementPresentVerification(ShippingMethod_Heading, browser)) {
			messagesMap.put("Shipping Method Page", "ANot able to Verify the Shipping Method Page after navigating from Shipping Information Page.");
			status = WARNING;
		    }
		}
		// Store the Address from Shipping info page into shared
		// properties HashMap
		String Shipping_Address = getElementByProperty(Ship_Address_Locator, browser).getText();
		if (!Shipping_Address.equals("")) {
		    Shipping_Address = Shipping_Address.substring(0, 47).trim();
		}
		sharedProperties.put("Address_Shipping_Info_Page", Shipping_Address);
	    } // end of for
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to Select shipping speed(Rx shipping/DL shipping/CL
     *          Shipping) from shipping Method page
     * @author - Imran
     * @Created -
     * @Modified By - Siva
     * @Modified Date -04-MAR-13
     ************************************************************* 
     */
    public static void selectShippingSpeedFromShippingMethodPage1(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String dailyLivingShippingSpeed = null;
	String contactLensShippingSpeed = null;
	String rxShippingSpeed = null;
	String CLStandardShippingText = null, CLOvernightShippingText = null;
	String Continue_BTN = "//input[@title='Continue' or @title='Continue checkout']~XPATH";

	String SelectDLStandardShipping_BTN = "input#SSSTDStandard~CSS";
	String SelectDLExpeditedShipping_BTN = "input#SSSTDExpeditedRadio~CSS";

	String SelectCLStandardShipping_BTN = "input#CLStandardRadio~CSS";
	String SelectCLOvernightShipping_BTN = "input#CLOvernightRadio~CSS";

	String SelectRxStandardShipping_BTN = "input#shippingspeedradio_standard~CSS";
	String SelectRxExpeditedShipping_BTN = "input#shippingspeedradio_expedited~CSS";
	String SelectRxOvernightShipping_BTN = "input#shippingspeedradio_overnight~CSS";

	String PaymentInformation_Heading = "//*[contains(text(),'Payment')]~XPATH";

	String CLStandardShipping_TXT = "//label[@for = 'CLStandardRadio']~XPATH";
	String CLOvernightShipping_TXT = "//label[@for = 'CLOvernightRadio']~XPATH";
	String Change_LNK = "//a[@title='Change Shipping Information']~XPATH";
	String ContactLensesHeader_H = "//h3[contains(text(),'Contact Lenses')]~XPATH";

	String CLStandardShipping__SDD_ON_DIV = "//div[@class='wid19p2em']/div~XPATH";
	String CLOvernightShipping__SDD_ON_DIV = "//div[@class='wid19p2em']/div[2]~XPATH";

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		dailyLivingShippingSpeed = dataMap.get("DailyLivingShippingSpeed").get(i);
		contactLensShippingSpeed = dataMap.get("ContactLensShippingSpeed").get(i);
		rxShippingSpeed = dataMap.get("RxShippingSpeed").get(i);

		if ("standard".equalsIgnoreCase(dailyLivingShippingSpeed)) {
		    if (isElementPresentVerification(SelectDLStandardShipping_BTN, browser)) {
			getElementByProperty(SelectDLStandardShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectDLStandardShipping_BTN from Shipping Method Page.");
		    }
		} else if ("expedited".equalsIgnoreCase(dailyLivingShippingSpeed)) {
		    if (isElementPresentVerification(SelectDLExpeditedShipping_BTN, browser)) {
			getElementByProperty(SelectDLExpeditedShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectDLExpeditedShipping_BTN from Shipping Method Page.");
		    }
		}

		if ("standard".equalsIgnoreCase(contactLensShippingSpeed)) {
		    // CL copy Check ----HASAN--26/FEB/2013 String
		    if (dataMap.get("CLShipMethodMessage") != null) {
			if (dataMap.get("CLShipMethodMessage").get(0).equalsIgnoreCase("Yes")) {
			    // CL copy Check ----HASAN--26/FEB/2013
			    String CLStandardShippingMessage = getTestData("CommonData", "GenaralInfo", "CLStandardShippingMessage", "Message");
			    String CLOvernightShippingMessage = getTestData("CommonData", "GenaralInfo", "CLOvernightShippingMessage", "Message");
			    if (SDDFlag.equalsIgnoreCase("ON")) {
				CLStandardShippingText = getElementByProperty(CLStandardShipping__SDD_ON_DIV, browser).getText();
				CLOvernightShippingText = getElementByProperty(CLOvernightShipping__SDD_ON_DIV, browser).getText();
			    } else {
				CLStandardShippingText = getElementByProperty(CLStandardShipping_TXT, browser).getText();
				CLOvernightShippingText = getElementByProperty(CLOvernightShipping_TXT, browser).getText();
			    }
			    if (!CLStandardShippingText.contains(CLStandardShippingMessage)) {
				messagesMap.put("CL - shipping method message", "Contact lens standard text is wrong in Shipping Method Page.");
				status = WARNING;
			    }
			    if (!CLOvernightShippingText.contains(CLOvernightShippingMessage)) {
				messagesMap.put("CL - shipping method message", "Contact lens overnight text is wrong in Shipping Method Page.");
				status = WARNING;
			    }
			}
		    }
		    if (isElementPresentVerification(SelectCLStandardShipping_BTN, browser)) {
			getElementByProperty(SelectCLStandardShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectCLStandardShipping_BTN from Shipping Method Page.");
		    }
		} else if ("overnight".equalsIgnoreCase(contactLensShippingSpeed)) {
		    if (isElementPresentVerification(SelectCLOvernightShipping_BTN, browser)) {
			getElementByProperty(SelectCLOvernightShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectCLOvernightShipping_BTN from Shipping Method Page.");
		    }
		} else if (!(dataMap.get("ExpVerification") == null)) {// #
		    // ADDED
		    // -
		    // SARAVANAN
		    // M
		    // -6-MAY-2013
		    // -
		    // Verifying
		    // unavailability
		    // of
		    // Expedited
		    // shiiping
		    // option
		    // for CL
		    // Products
		    if (dataMap.get("ExpVerification").get(i).equalsIgnoreCase("Yes")) {
			if (isElementPresentVerification(ContactLensesHeader_H, browser)) {
			    if (getElementByProperty("//div[contains(@class,'prodInnerContainer')]", browser).getText().contains("Expedited")) {
				messagesMap.put("Expedited option - Contact Lenses", "The Expedited option should not displayed for CL Products");
				status = WARNING;
			    }
			}
		    }
		}

		if ("standard".equalsIgnoreCase(rxShippingSpeed)) {
		    if (isElementPresentVerification(SelectRxStandardShipping_BTN, browser)) {
			getElementByProperty(SelectRxStandardShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectRxStandardShipping_BTN from Shipping Method Page.");
		    }
		} else if ("expedited".equalsIgnoreCase(rxShippingSpeed)) {
		    if (isElementPresentVerification(SelectRxExpeditedShipping_BTN, browser)) {
			getElementByProperty(SelectRxExpeditedShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectRxExpeditedShipping_BTN from Shipping Method Page.");
		    }
		} else if ("overnight".equalsIgnoreCase(rxShippingSpeed)) {
		    if (isElementPresentVerification(SelectRxOvernightShipping_BTN, browser)) {
			getElementByProperty(SelectRxOvernightShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectRxOvernightShipping_BTN from Shipping Method Page.");
		    }
		}

	    }// end of for loop

	    // new code change link ----HASAN--23/FEB/2013

	    if ((dataMap.get("ChangeLink") != null) && (dataMap.get("ChangeLink").get(0).equalsIgnoreCase("Yes"))) {
		if (!isElementPresentVerifyClick(Change_LNK, browser)) {
		    throw new Exception("Not able to click on Change Link in Shipping Method Page.");
		}
	    } else {
		if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
		    throw new Exception("Not able to click on Continue Button from Shipping Method Page.");
		}
		if (!isElementPresentVerification(PaymentInformation_Heading, browser)) {
		    messagesMap.put("Expected Target Page", "Not able to Verify the Payment Information Page after navigating from Shipping Method Page.");
		    status = WARNING;
		}
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to click on Continue Button in Payment Options Page (
     *          Old Method)
     * @author - Imran
     * @Created -
     * @Modified By - Siva
     * @Modified Date -08-Nov-12
     ************************************************************* 
     */
    public static void clickOnContinueFromPaymentInfoPage(EventFiringWebDriver browser, StepBean stepBean) {
	String Continue_BTN = "input[title='Continue']~CSS";
	String ReviewOrder_Heading = "//h2[contains(text(),'Review Order & Submit')]~XPATH";
	String status = FAIL;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    if (isElementPresentVerification(Continue_BTN, browser)) {
		getElementByProperty(Continue_BTN, browser).click();
	    }
	    if (!isElementPresentVerification(ReviewOrder_Heading, browser)) {
		messagesMap.put("Expected Target Page", "Not able to Verify the Order Review Page after navigating from Payment Options Page.");
		status = WARNING;
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to perform checkbox click
     * @author - Imran
     * @Created - March 23rd, 2012
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void performCheckBoxClick(String ObjectToBeClicked, EventFiringWebDriver browser) {
	try {
	    WebElement checkBox = getElementByProperty(ObjectToBeClicked, browser);
	    checkBox.click();
	} catch (Exception e) {
	    ;
	}
    }

    /**
     ************************************************************************ 
     * @Purpose - Method to select Payment options and Billing address in
     *          Payment Info page
     * @Input -
     * @author - Vishnu
     * @Created - 22 May 2012
     * @Modified By -Siva
     * @Modified Date - 22-APR-2013
     ************************************************************************ 
     */
    public static void paymentOptionsSelection1(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String CreditCard_RADIO = "input#paymentCC~CSS";
	String BillMeLater_RADIO = "input#paymentBML~CSS";
	String PayPal_RADIO = "input[value='paypal']~CSS";
	String Continue_BTN = "//input[@title='Continue' or @title='continue' or @title='Continue checkout']~XPATH";
	String CardType_LST = "select#creditcardtype~CSS";
	String CardNumber_TXT = "//input[@id='credit_card_number' or @id='ccno']~XPATH";
	String ExpirationMonth_LST = "//select[@id='expdate' or @id='exp_month']~XPATH";
	String ExpirationYear_LST = "//select[@id='yr1' or @id='exp_year' or @id='yr']~XPATH";
	String HomeAddress_RADIO = "//input[@id='chrisaddress1' or @id='homeaddressradio']~XPATH";
	// String ShippingAddress_RADIO =
	// "//input[@id='chrisaddress2' or @id='shippingaddressradio']~XPATH";
	String NewBillingAddress_RADIO = "//input[@id='billaddrnew' or @id='usebillinginfo']~XPATH";
	String SameAsShippingAddress_CHK = "input#checkbill~CSS";
	String FirstName_TXT = "//input[@id='fname' or @id='firstname' or @id='ccholderfname']~XPATH";
	String LastName_TXT = "//input[@id='lastname' or @id='lname' or @id='ccholderlname']~XPATH";
	String StreetAddress_TXT = "//input[@id='address2' or @id='newbillccaddress']~XPATH";
	String City_TXT = "//input[@id='city2' or @id='newbillcccity']~XPATH";
	String State_LST = "//select[@id='newbillccstate' or @id='newBillState']~XPATH";
	String ZIPCode_TXT = "//input[@id='newbillcczip' or @id='zip2']~XPATH";
	String SaveBillingAdd_CHK = "//input[@id='yesBill' or @id='yes']~XPATH";
	String UpdateCCInformation_LNK = "//a[@title='Update Credit Card Details' or @title='Edit payment information']~XPATH";
	String NewCreditCard_RADIO = "//p/input[@id='charge_cc' or @id='newcc' or @id='ccnew']~XPATH";
	String SelectaPaymentMethodTypeHeader_ELM = "//h3[contains(text(),'Select a payment method')]~XPATH";
	String EditCreditCartInformation_LNK = "//a[contains(text(),'Edit payment information')]~XPATH";
	String ReviewOrderAndSubmit_HEADER = "//*[contains(text(),'Order review') or contains(text(),'Review Order')]~XPATH";
	String BMLHomeAddress_RADIO = "input#homeaddressradio~CSS";
	// String BMLFirstName_TXT = "input#ccholderfname~CSS";
	// String BMLLastName_TXT = "input#ccholderlname~CSS";
	String BMLEmailAddress_TXT = "input#newbillemailid~CSS";
	String BMLPhoneNumber_TXT = "input#newbillphoneno~CSS";
	String BML_DOB_MONTH_LST = "//select[@name='/commerce/payment/bml/BMLFormHandler2.month' or @id='dobmm']~XPATH";
	String BML_DOB_DAY_LST = "//select[@name='/commerce/payment/bml/BMLFormHandler2.date' or @id='dobdd']~XPATH";
	String BML_DOB_YEAR_LST = "//select[@name='/commerce/payment/bml/BMLFormHandler2.year' or @id='dobyyyy']~XPATH";
	String BML_SSN_TXT = "input#newbillSSN~CSS";
	String BML_IAgree_CHK = "input#eTC~CSS";
	// SIMEON - 8/28/13 Corrected capitalization; 10/29/13 Again... it keeps
	// changing.
	String BML_AgreeandContinue_BTN = "//input[@title='I agree and continue order' or @title='I Agree and Continue Order']~XPATH";
	String HavePayPalAccount_HEADER = "//h2[contains(text(),'Choose a way to pay')]~XPATH";
	String PayPal_Username_TXT = "input#login_email~CSS";
	String PayPal_Password_TXT = "input#login_password~CSS";
	String PayPal_Login_BTN = "input#submitLogin~CSS";
	String PayPal_Continue_BTN = "input#continue~CSS";
	String BMLContinue_BTN = "//input[@title='Continue']~XPATH";
	// String PaymentInformation_HEADER =
	// "//span[contains(text(),'Payment Information')]~XPATH";

	// Redeem options
	String RedeemBalanceRewards_H = "//h3[contains(text(),'Redeem Balance Rewards')]~XPATH";
	String RedeemPoints_LST = "//select[@id='selectedAwardId']~XPATH";
	String BeforeTotalPrice = "//div[@class='totalPrc']~XPATH";
	String AfterTotalPrice = "//div[@class='totalPrc']~XPATH";

	String cardType = null;
	String cardNumber = null;
	String expireMonth = null;
	String expireYear = null;
	String firstName = null;
	String lastName = null;
	String streetAddress = null;
	String city = null;
	String state = null;
	String zipCode = null;
	String emailAddress = null;
	String phoneNumber = null;

	String dobMonth = null;
	String dobDay = null;
	String dobYear = null;
	String ssn = null;

	String payPalUserName = null;
	String payPalPassWord = null;

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }

	    if (dataMap.get("CCInputFileName") != null && dataMap.get("CCInputFileName").size() > 0 && dataMap.get("CCSheetName") != null && dataMap.get("CCSheetName").size() > 0
		    && dataMap.get("CCRowId") != null && dataMap.get("CCRowId").size() > 0) {
		cardType = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "CardType");
		cardNumber = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "CardNumber");
		expireMonth = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ExpireMonth");
		expireYear = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ExpireYear");
	    }

	    if (dataMap.get("CustomerInputFileName") != null && dataMap.get("CustomerInputFileName").size() > 0 && dataMap.get("CustomerSheetName") != null
		    && dataMap.get("CustomerSheetName").size() > 0 && dataMap.get("CustomerRowId") != null && dataMap.get("CustomerRowId").size() > 0) {
		firstName = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "FirstName");
		lastName = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "LastName");
		streetAddress = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "StreetAddress");
		city = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "City");
		state = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "State");
		zipCode = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "ZipCode");
		emailAddress = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "EmailAddress");
		phoneNumber = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "PhoneNumber");
		dobMonth = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "DOB-Month");
		dobDay = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "DOB-Day");
		dobYear = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "DOB-Year");
		ssn = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "SSN");
	    }

	    // In order to select the Redemption points - SARAVANAN M -9/10/2013
	    // Select the redemption points and validate the rewards applied -
	    // Rukmani RM - 23/10/2013

	    if (dataMap.containsKey("RedeemPtsOption") && !dataMap.get("RedeemPtsOption").get(0).equals("-")) {
		if (isElementPresentVerification(RedeemBalanceRewards_H, browser)) {
		    int Option = Integer.parseInt(dataMap.get("RedeemPtsOption").get(0).trim());
		    String BeforeRedemptionVal = null;
		    float ConvPriceBR = 0;
		    String BeforeRedemption = getElementByProperty(BeforeTotalPrice, browser).getText();
		    BeforeRedemptionVal = BeforeRedemption.split("\\$")[1];
		    System.out.println("BeforeRedemptionVal:" + BeforeRedemptionVal);
		    ConvPriceBR = Float.parseFloat(BeforeRedemptionVal);

		    List<WebElement> PointsList = new Select(getElementByProperty(RedeemPoints_LST, browser)).getOptions();
		    float ConvRedemptionValue = 0;
		    String RedemptionValue = PointsList.get(Option).getText();
		    RedemptionValue = RedemptionValue.split("\\$")[1];
		    ConvRedemptionValue = Float.parseFloat(RedemptionValue);
		    new Select(getElementByProperty(RedeemPoints_LST, browser)).selectByIndex(Option);
		    String AfterRedemption = getElementByProperty(AfterTotalPrice, browser).getText();
		    String AfterRedemptionVal = AfterRedemption.split("\\$")[1];
		    float ConvPriceAR = Float.parseFloat(AfterRedemptionVal);
		    if (ConvPriceBR != ConvPriceAR + ConvRedemptionValue) {
			messagesMap.put("Expected Target Page", "Selected Burn points is not deducted from the total price");
			status = WARNING;
		    }
		} else {
		    messagesMap.put("Expected Target Page", "Points redemption section was not found");
		    status = WARNING;
		}
	    }

	    if (dataMap.get("PaypalInputFileName") != null && dataMap.get("PaypalInputFileName").size() > 0 && dataMap.get("PaypalSheetName") != null && dataMap.get("PaypalSheetName").size() > 0
		    && dataMap.get("PaypalRowId") != null && dataMap.get("PaypalRowId").size() > 0) {
		payPalUserName = getTestData(dataMap.get("PaypalInputFileName").get(0), dataMap.get("PaypalSheetName").get(0), dataMap.get("PaypalRowId").get(0), "UserName");
		payPalPassWord = getTestData(dataMap.get("PaypalInputFileName").get(0), dataMap.get("PaypalSheetName").get(0), dataMap.get("PaypalRowId").get(0), "Password");
	    }
	    // New piece of code---Guest User--Started
	    if (dataMap.get("GuestPayment") != null) {
		if (dataMap.get("GuestPayment").get(0).equalsIgnoreCase("CreditCard")) {
		    getElementByProperty(Continue_BTN, browser).click();
		    selectByVisibleText(CardType_LST, cardType, browser);
		    clearAndEnterText(CardNumber_TXT, cardNumber, browser);
		    selectByVisibleText(ExpirationMonth_LST, expireMonth, browser);
		    selectByVisibleText(ExpirationYear_LST, expireYear, browser);
		    if (dataMap.get("SameAsShippingAddress").get(0).equalsIgnoreCase("true")) {
			getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		    } else {
			clearAndEnterText(FirstName_TXT, firstName, browser);
			clearAndEnterText(LastName_TXT, lastName, browser);
			clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
			clearAndEnterText(City_TXT, city, browser);
			selectByVisibleText(State_LST, state, browser);
			clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    }
		    getElementByProperty(Continue_BTN, browser).click();
		}
	    }
	    // New piece of code---Guest User--Ended

	    if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("CreditCard")) {
		// Existing Credit Card Option--by default existing credeit card
		// will be selected
		/*
		 * if (isElementPresentVerification(CreditCard_RADIO, browser))
		 * { getElementByProperty(CreditCard_RADIO, browser).click(); }
		 */

		// 18-02-13--Added by SIVA-- Clicking on continue button if
		// Select Payment Method Type header found(SDD)
		if (SDDFlag.equalsIgnoreCase("ON")) {
		    if (isElementPresentVerification(SelectaPaymentMethodTypeHeader_ELM, browser) && !isElementPresentVerification(EditCreditCartInformation_LNK, browser)) {
			if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
			    throw new Exception("Not able to click Continue Button");
			}
		    }
		}
		if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("HomeAddress")) {
		    getElementByProperty(HomeAddress_RADIO, browser).click();
		} else if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("NewBillingAddress")) {
		    getElementByProperty(NewBillingAddress_RADIO, browser).click();
		    if ((dataMap.get("SameAsShippingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		    } else {
			clearAndEnterText(FirstName_TXT, firstName, browser);
			clearAndEnterText(LastName_TXT, lastName, browser);
			clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
			clearAndEnterText(City_TXT, city, browser);
			selectByVisibleText(State_LST, state, browser);
			clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    }
		    if ((dataMap.get("SaveBillingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SaveBillingAdd_CHK, browser).click();
		    }
		}
		if (isElementPresentVerification(Continue_BTN, browser)) {
		    getElementByProperty(Continue_BTN, browser).click();
		}

	    } else if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("NewCreditCard")) {
		// New Credit Card Option

		if (isElementPresentVerification(UpdateCCInformation_LNK, browser)) {
		    getElementByProperty(UpdateCCInformation_LNK, browser).click();
		} else if (!isElementPresentVerification(CardType_LST, browser)) {
		    if (isElementPresentVerification(Continue_BTN, browser)) {
			getElementByProperty(Continue_BTN, browser).click();
		    }
		}
		getElementByProperty(NewCreditCard_RADIO, browser).click();
		selectByVisibleText(CardType_LST, cardType, browser);
		clearAndEnterText(CardNumber_TXT, cardNumber, browser);
		selectByVisibleText(ExpirationMonth_LST, expireMonth, browser);
		selectByVisibleText(ExpirationYear_LST, expireYear, browser);
		if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("HomeAddress")) {
		    getElementByProperty(HomeAddress_RADIO, browser).click();
		} else if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("NewBillingAddress")) {
		    getElementByProperty(NewBillingAddress_RADIO, browser).click();
		    if ((dataMap.get("SameAsShippingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		    } else {
			clearAndEnterText(FirstName_TXT, firstName, browser);
			clearAndEnterText(LastName_TXT, lastName, browser);
			clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
			clearAndEnterText(City_TXT, city, browser);
			selectByVisibleText(State_LST, state, browser);
			clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    }
		    if ((dataMap.get("SaveBillingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SaveBillingAdd_CHK, browser).click();
		    }
		}
		if (isElementPresentVerification(Continue_BTN, browser)) {
		    getElementByProperty(Continue_BTN, browser).click();
		}
	    } else if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("BillMeLater") && isElementPresentVerification(BillMeLater_RADIO, browser)) {
		// Bill Me Later Option
		getElementByProperty(BillMeLater_RADIO, browser).click();
		getElementByProperty(Continue_BTN, browser).click();
		if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("HomeAddress"))
		    getElementByProperty(BMLHomeAddress_RADIO, browser).click();
		else if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("NewBillingAddress")) {
		    getElementByProperty(NewBillingAddress_RADIO, browser).click();
		}
		if ((dataMap.get("SameAsShippingAddress").get(0)).equalsIgnoreCase("true")) {
		    getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		} else {
		    clearAndEnterText(FirstName_TXT, firstName, browser);
		    clearAndEnterText(LastName_TXT, lastName, browser);
		    clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
		    clearAndEnterText(City_TXT, city, browser);
		    selectByVisibleText(State_LST, state, browser);
		    clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    clearAndEnterText(BMLEmailAddress_TXT, emailAddress, browser);
		    clearAndEnterText(BMLPhoneNumber_TXT, phoneNumber, browser);
		}
		if ((dataMap.get("SaveBillingAddress").get(0)).equalsIgnoreCase("true")) {
		    getElementByProperty(SaveBillingAdd_CHK, browser).click();
		}
		if (isElementPresentVerification(BML_IAgree_CHK, browser)) {
		    selectByVisibleText(BML_DOB_MONTH_LST, dobMonth, browser);
		    selectByVisibleText(BML_DOB_DAY_LST, dobDay, browser);
		    selectByVisibleText(BML_DOB_YEAR_LST, dobYear, browser);
		    clearAndEnterText(BML_SSN_TXT, ssn, browser);
		    getElementByProperty(BML_IAgree_CHK, browser).click();
		}
		if (isElementPresentVerification(BMLContinue_BTN, browser)) {
		    getElementByProperty(BMLContinue_BTN, browser).click();
		} else {
		    if (!isElementPresentVerifyClick(BML_AgreeandContinue_BTN, browser)) {
			throw new Exception("Not able to Click on Agree And Cotinue Button");
		    }
		}
	    } else if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("PayPal") && isElementPresentVerification(PayPal_RADIO, browser)) {
		// Paypal Option
		getElementByProperty(PayPal_RADIO, browser).click();
		getElementByProperty(Continue_BTN, browser).click();
		if (isElementPresentVerification(HavePayPalAccount_HEADER, browser)) {
		    clearAndEnterText(PayPal_Username_TXT, payPalUserName, browser);
		    clearAndEnterText(PayPal_Password_TXT, payPalPassWord, browser);
		    getElementByProperty(PayPal_Login_BTN, browser).click();
		    Thread.sleep(5000);
		    getElementByProperty(PayPal_Continue_BTN, browser).click();
		}
	    }

	    /*
	     * if (isElementPresentVerification(UpdateCCInformation_LNK,
	     * browser)) { getElementByProperty(UpdateCCInformation_LNK,
	     * browser).click(); }
	     */

	    if (!isElementPresentVerification(ReviewOrderAndSubmit_HEADER, browser)) {
		messagesMap.put("Expected Target Page", "Review Order and Submit Page Header was not found");
		status = WARNING;
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************************ 
     * @Purpose - Method to Customer selects required option(Submit, change
     *          shipping info, change pickup details,....) from Order Review
     *          Page
     * @Input -
     * @author - Siva
     * @Created - 27 May 2012
     * @Modified By - Hasan
     * @Modified Date -JULY-28-2013
     ************************************************************************ 
     */
    public static void selectOptionFromReviewOrderPage1(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String ShippingInfo_Change_LNK = "a[title='Change Shipping Information']~CSS";
	String ShippingMethod_Change_LNK = "a[title='Change Shipping Method']~CSS";
	String BillingInfo_Change_LNK = "a[title='Change Billing Information']~CSS";
	String SubmitOrder_BTN = "//input[@id='submitTop' or @alt='Submit Order' or @title='Submit order']~XPATH";
	String ShippingInformation_Header = "//h2[contains(text(),'Shipping Information')]~XPATH";
	String ShipMethod_Header = "//h2[contains(text(),'Ship Method')]~XPATH";
	String paymentInfo_Header = "//h2[contains(text(),'Payment Information')]~XPATH";
	String OrderConfirmation_Message = "//strong[contains(text(),'Thank You! Your order is complete') or contains(text(),'Thank you for shopping at Walgreens') or contains(text(),'Thank You for shopping at Walgreens')]~XPATH";
	String ChangeStoreOrPickupTime = "a[title='Change store or Pickup time']~CSS";
	String PickupLocationPage_Header = "//*[contains(text(),'Pickup Location') or contains(text(),'Pickup details')]~XPATH";
	String WagCoupon_IMG = "img[title*='Print Coupon for your $25 gift card!']~CSS";
	String PSCDetailsDiv_ELM = "//div[contains(@class,'mrgAuto')]~XPATH";
	String TermsAndCondition_CHK = "//input[@id='terms']~XPATH";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		if (dataMap.get("SubmitOrder").get(i).equalsIgnoreCase("Yes")) {
		    // Hasan - 26/Jul/2013 terms and condition check box
		    if (isElementPresentVerification(TermsAndCondition_CHK, browser)) {
			String termsAndCondition = getElementByProperty(TermsAndCondition_CHK, browser).getAttribute("value");
			if (termsAndCondition.equals(true)) {
			    if (!isElementPresentVerifyClick(TermsAndCondition_CHK, browser)) {
				throw new Exception("Not able to Click on terms and conditon check box");
			    }
			}
		    }
		    if (!isElementPresentVerifyClick(SubmitOrder_BTN, browser)) {
			throw new Exception("Not able to Click on Submit Order");
		    }
		    // #SARAVANAN M - June-24-2013 -will wait here to verify the
		    // order confirmation message
		    if (dataMap.containsKey("NewRefillRx")) {
			if (dataMap.get("NewRefillRx").get(0).equalsIgnoreCase("Yes")) {
			    do {
				// do nothing
			    } while (!isElementPresentVerification(OrderConfirmation_Message, browser));
			}
		    } else {
			if (!isElementPresentVerification(OrderConfirmation_Message, browser)) {
			    throw new Exception("Not able to Find the Order Confiramtion Message");
			}
		    }
		}
		if (dataMap.get("ChangeStoreOrPickUpTime").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(ChangeStoreOrPickupTime, browser)) {
			throw new Exception("Not able to click on Change Pickup Store or Pickup time link");
		    }
		    if (!isElementPresentVerification(PickupLocationPage_Header, browser)) {
			messagesMap.put("Pickup Location Page", "Page is not Navigated to Pickup Location Page after clicking ChangeStore link");
			status = WARNING;
		    }
		}
		if (dataMap.get("ChangeShippingInformation").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(ShippingInfo_Change_LNK, browser)) {
			throw new Exception("Not able to click on Shipping Info Change Link");
		    }
		    if (!isElementPresentVerification(ShippingInformation_Header, browser)) {
			messagesMap.put("Shipping INformation Page", "Page is not Navigated to Shipping INformation Page after clicking ChangeShippingInformation link");
			status = WARNING;
		    }
		}
		if (dataMap.get("ChangeShippingMethod").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(ShippingMethod_Change_LNK, browser)) {
			throw new Exception("Not able to click on ChangeShippingMethod Link");
		    }
		    if (!isElementPresentVerification(ShipMethod_Header, browser)) {
			messagesMap.put("Shipping Method Page", "Page is not Navigated to Shipping Method Page after clicking ChangeShippingMethod link");
			status = WARNING;
		    }
		}
		if (dataMap.get("ChangeBillingInformation").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(BillingInfo_Change_LNK, browser)) {
			throw new Exception("Not able to click on ChangeBillingInformation Link");
		    }
		    if (!isElementPresentVerification(paymentInfo_Header, browser)) {
			messagesMap.put("Payment Info Page", "Page is not Navigated to Payment Info Page after clicking ChangeBillingInformation link");
			status = WARNING;
		    }
		}

		if (!(dataMap.get("WagCouponVerify") == null)) {
		    if (dataMap.get("WagCouponVerify").get(i).equalsIgnoreCase("Yes")) {
			if (isElementPresentVerification(WagCoupon_IMG, browser)) {
			    messagesMap.put("Wag $25 Coupon for Transfer Rx", "The Coupon is displayed for the Medicare/medicaid user");
			    status = WARNING;
			}
		    }
		}
		if (dataMap.get("VerifyPSCTempID") != null) {
		    if (dataMap.get("VerifyPSCTempID").get(0).equalsIgnoreCase("Yes")) {
			List<WebElement> pTagsinPSCOrderDetailsDiv = getElementByProperty(PSCDetailsDiv_ELM, browser).findElements(By.tagName("p"));
			String PSCTempID = null;
			for (int k = 0; k < pTagsinPSCOrderDetailsDiv.size(); k++) {
			    if (pTagsinPSCOrderDetailsDiv.get(k).getText().contains("Temp ID")) {
				PSCTempID = pTagsinPSCOrderDetailsDiv.get(k + 1).getText();
				break;
			    }
			}
			if (PSCTempID.length() != 12) {
			    messagesMap.put("PSC Temp ID", "Temp ID is not generated or its lenght is not equal to 12");
			    status = WARNING;
			}
		    }
		}
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     * 
     ************************************************************* 
     * @Purpose - Method to extract Order ID's in the order confirmation Page
     * @author - Vishnu
     * @Created - 30-May-2012
     * @Modified By -Thangaraj R
     * @Modified Date -29-Aug-2013
     ************************************************************* 
     */

    public static boolean getOrderIDs(EventFiringWebDriver browser, String OrderType, Map<String, List<String>> dataMap)

    {
	int OrderIdCounter = 0;
	WebElement OrderConfirmationContainer = null;
	List<WebElement> OrderIDsHolder = null;
	String CurrentOrderID = null;
	// String OrderIDContainer_ELM =
	// "//div[@class='th_652' or @id='leftNavShippingInfo' or @id='full_902']~XPATH";
	String OrderIDContainer1_ELM = "//div[contains(@class,'mrgTop0p7em mrgBtm0p5em wid55p5em')]~XPATH"; // SIMEON
	// -
	// 9/11/13
	// -
	// Added
	String ExpressOrderID_ELM = "//p[contains(text(),'Order #')]~XPATH";
	int Flag = 0, j = 0, k = 0, loopcounter = 0;
	boolean getOrderdetails = false;
	try {
	    if (OrderType != null && OrderType.equalsIgnoreCase("ExpressRefill")) {
		CurrentOrderID = getElementByProperty(ExpressOrderID_ELM, browser).getText().split(":")[1].trim();
		TestDataDBManager.putTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "OrderID_1", CurrentOrderID);
		getOrderdetails = true;
	    } else {
		OrderConfirmationContainer = getElementByProperty(OrderIDContainer1_ELM, browser);
		OrderIDsHolder = OrderConfirmationContainer.findElements(By.xpath("//p/strong"));
		for (int i = 0; i < OrderIDsHolder.size(); i++) {
		    if (OrderIDsHolder.get(i).getText().contains("Order #")) {
			OrderIdCounter++;
			String CurrentOrderIDSplitElements[] = OrderIDsHolder.get(i).getText().split("#");
			for (k = 1; k < CurrentOrderIDSplitElements.length; k++) {
			    CurrentOrderID = OrderIDsHolder.get(i).getText().split("#")[k].replace(",", "").trim();
			    j = loopcounter + k;
			    TestDataDBManager.putTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "OrderID_" + j,
				    CurrentOrderID.toUpperCase());
			    if (!(CurrentOrderID.charAt(0) == 'z' || CurrentOrderID.charAt(0) == 'Z')) {
				Flag++;
			    }
			}

			// To Change the Order type in case of non-Rx order -
			// SARAVANAN M - OCT-9-2013
			if (CurrentOrderID.length() == 10) {
			    OrderType = "Non-Rx";
			    System.out.println("Order ID=" + CurrentOrderID);
			}

			// START-Updated--Thangaraj-29-Aug-2013
			if (OrderType.equalsIgnoreCase("ShipToCustomer")) {
			    if (CurrentOrderID.charAt(0) == ('W') || CurrentOrderID.charAt(0) == ('G') || CurrentOrderID.charAt(0) == ('T')) { // SIMEON
				// -
				// 9/11/13
				// -
				// Changed
				// index
				// to
				// 0
				getOrderdetails = true;
			    }
			}
			// ENDED
			loopcounter = loopcounter + (CurrentOrderIDSplitElements.length - 1);
			// j = j + 1;// increasing the order ID header number
		    }
		}
		if (!(OrderType != null && OrderType.equalsIgnoreCase("ShipToCustomer"))) {
		    if (Flag == OrderIdCounter) {
			getOrderdetails = true;
		    }
		}
	    }
	} catch (Exception e) {
	    getOrderdetails = false;
	}
	return getOrderdetails;
    }

    /**
     * 
     ************************************************************* 
     * @Purpose - Method to Navigate back to Shopping Cart from the Checkout
     *          flow pages.
     * @author - Siva
     * @Created - 20-Aug-12
     * @Modified By - Siva
     * @Modified Date -4-Feb-2013
     ************************************************************* 
     */
    public static void backtoCartLinkFunctionality(EventFiringWebDriver browser, StepBean stepBean)

    {
	String status = PASS;
	String backtoCart_LNK = "//*[@alt='Back to Cart'or contains(text(),' Back to cart')]~XPATH";
	String ShoppingCart_ELM = "//*[contains(text(),'Shopping Cart')]~XPATH";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    if (!isElementPresentVerifyClick(backtoCart_LNK, browser)) {
		throw new Exception("Not able to click on back to cart link");
	    }
	    if (!isElementPresentVerification(ShoppingCart_ELM, browser)) {
		messagesMap.put("Expected Target page", "Page is not navigated to Shopping cart Page");
		status = WARNING;
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to Remove all products from shopping List
     * @author - Mohana Janakavalli K
     * @Created - 07-Feb-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void removeItemsFromShoppingList(EventFiringWebDriver browser, StepBean stepBean) {
	String status = PASS;
	String ItemsinShopList_ELM = "//b[contains(text(),' Items')]~XPATH";
	String ListURL = "store/shoppinglist/showwishlist.jsp";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    String listurl = EcommTestRunner.config.getString("walgreensURL") + ListURL;
	    getUrl(browser, listurl);
	    if (!getElementByProperty(ItemsinShopList_ELM, browser).getText().contains("0 Items")) {
		List<WebElement> listItems = getElementsListByLinkText("Remove from list", browser);
		int listItemsSize = listItems.size();
		while (listItemsSize > 0) {
		    listItems.get(0).click();
		    // reset it
		    listItems = null;
		    listItems = getElementsListByLinkText("Remove from list", browser);
		    if (listItems != null) {
			listItemsSize = listItems.size();
		    }
		}
		String text = getElementByProperty(ItemsinShopList_ELM, browser).getText();
		System.out.println(text);
		if (!getElementByProperty(ItemsinShopList_ELM, browser).getText().contains("0  Items")) {
		    throw new Exception("Not able to find 0 Itmes in List Message");
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to Verify the mails triggered to users on placing an
     *          order (order checking will be done only in the 1st page)
     * @author - Chezhiyan. E
     * @Created - 30-Dec-2011
     * @Modified By - Siva
     * @Modified Date -15-nov-2013
     ************************************************************* 
     */

    public static void yahooMailOrderCheck(EventFiringWebDriver browser, ScenarioBean scenariobean, StepBean stepBean, Map<String, List<String>> dataMap) throws Exception {
	String status = PASS;
	String YahooInbox_BTN = "li[id='Inbox']>a~CSS";
	String YahooMailTable_TBL = "div[id='shellcontent']~CSS";
	String SubjectLinkToClick_LNK = "//div[@class=\"list-view-items\"][@role=\"presentation\"]/div[POSITION]/div[2]/div[2]";
	String SSOrderNumber_ELM = "//*[contains(text(),'Order #')]~XPATH";
	String Mailcontent_DIV = "//div[contains(@class,'msg-body inner')]~XPATH";
	Map<String, String> messagesMap = null;
	WebElement YahooMailTable = null, SubjectLink = null;
	List<WebElement> MailSubjectHolder = null;
	int RowIncrement, NoOfRows = 0;
	String SubjectText = null, CurrentOrderID = null, MailContent = null, OrderNo = null, OrderPickupLocation = null, VerifySSOrderEmail = null, VerifyRxOrderEmail, SSOrderNumber = null;
	String OrderNumberElementText = null;
	String[] RxOrderNumber = new String[4];
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }

	    int intTotalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < intTotalRowCount; i++) {
		isElementPresentVerifyClick(YahooInbox_BTN, browser);
		YahooMailTable = getElementByProperty(YahooMailTable_TBL, browser);
		MailSubjectHolder = YahooMailTable.findElements(By.className("subj"));
		NoOfRows = MailSubjectHolder.size();

		if (dataMap.containsKey("OrderNumber") && dataMap.get("OrderNumber").get(0).equalsIgnoreCase("Yes")) {
		    CurrentOrderID = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "OrderNumber");
		    OrderNo = "Yes";
		} else {
		    CurrentOrderID = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "OrderID_1");
		}
		// CurrentOrderID =
		// getTestData(dataMap.get("InputFileName").get(i),
		// dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i),
		// "OrderID_1");
		OrderPickupLocation = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "StoreToVerify");
		// Newly added parameters
		VerifySSOrderEmail = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "VerifySSOrderEmail");
		VerifyRxOrderEmail = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "VerifyRxOrderEmail");
		for (int ordernumber = 1; ordernumber < 5; ordernumber++) {
		    String OrderID = null;
		    if (OrderNo != null && OrderNo.equalsIgnoreCase("Yes")) {
			OrderID = CurrentOrderID;
		    } else {
			OrderID = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "OrderID_" + ordernumber);
		    }
		    if (OrderID == null) {
			OrderID = CurrentOrderID;
			break;
		    }
		    int noofCharactersinOrderId = OrderID.length();
		    if (noofCharactersinOrderId == 10 || noofCharactersinOrderId == 9) {
			SSOrderNumber = OrderID;
		    } else {
			RxOrderNumber[ordernumber - 1] = OrderID;
		    }

		}
		// since SS order ID's are stored as the last order ID, checking
		// the subject alone to see if the order is placed
		if (!OrderPickupLocation.equals("-")) {
		    for (RowIncrement = 1; RowIncrement <= NoOfRows; RowIncrement++) {
			SubjectLink = getElementByProperty(SubjectLinkToClick_LNK.replace("POSITION", Integer.toString(RowIncrement)), browser);
			SubjectText = SubjectLink.getText();
			System.out.println("SubjectText" + SubjectText);

			// Adding verifying Rx and SS Emails without Effecting
			// the
			// Old
			// Code---18-FEB-2013-SIVA
			if (SubjectText.contains("Order Confirmation Details")) {
			    SubjectLink.click();
			    // clicking the particular order Mail, to see if it
			    // has the RX Order ID
			    // MailContent = browser.getPageSource();
			    MailContent = getElementByProperty(Mailcontent_DIV, browser).getText();
			    if (MailContent.contains(CurrentOrderID)) {
				messagesMap.put("Yahoo mail, Order verification", "Mail sent for RX Order ID: " + CurrentOrderID);
				if (!MailContent.contains(OrderPickupLocation)) {
				    messagesMap.put("Yahoo mail, Order verification", "Store details not present in the mail sent for order: " + CurrentOrderID);
				    status = WARNING;
				}
				break;
			    }
			    isElementPresentVerifyClick(YahooInbox_BTN, browser);
			}
		    }
		}
		// Added by Angeline - 24Oct2013
		// Verifying Order Confirmation Email triggered when Cancelling
		// An Order
		// (Validating the subject line to confirm the email is sent for
		// cancelling the order)
		if (dataMap.containsKey("CanceledOrderCheck") && dataMap.get("CanceledOrderCheck").get(0).equals("Yes")) {

		    if (dataMap.containsKey("isPickUpCancel") && dataMap.get("isPickUpCancel").get(0).equals("Yes")) {
			String pickupCancel = "//span[contains(text(),'Your store pickup order has been cancelled.')]~XPATH";
			String OrderText = "//*[contains(text(),'" + CurrentOrderID.trim() + "')]~XPATH";
			if (isElementPresentVerifyClick(pickupCancel, browser)) {
			    if (!isElementPresentVerification(OrderText, browser)) {
				throw new Exception("Mail not triggered after Cancelling the Pick-Up Order");
			    }
			}
		    } else {
			System.out.println("Mail Subj=" + getElementByProperty(SSOrderNumber_ELM, browser).getText());
			if (!(getElementByProperty(SSOrderNumber_ELM, browser).getText().contains("Canceled"))) {
			    throw new Exception("Mail not triggered after Cancelling the order");
			}
		    }
		}
		// Verifying SS Confirmation Email(Only validating the Order
		// number to make sure email is sent to the user
		if (VerifySSOrderEmail.equalsIgnoreCase("Yes")) {
		    String SSEmailLink = "//*[contains(text(),'Order Details " + SSOrderNumber + "')]~XPATH";
		    if (!isElementPresentVerifyClick(SSEmailLink, browser)) {
			throw new Exception("Not able to click on SS Order Confirmation Email");
		    }
		    OrderNumberElementText = getElementByProperty(SSOrderNumber_ELM, browser).getText().toUpperCase();
		    if (!OrderNumberElementText.contains(SSOrderNumber)) {
			messagesMap.put("Yahoo mail, Order verification", "Order Number is not Found : " + SSOrderNumber);
			status = WARNING;
		    }
		    isElementPresentVerifyClick(YahooInbox_BTN, browser);
		    Thread.sleep(2000);
		}
		// Verifying Rx Confirmation Email(Only validating the Order
		// number to make sure email is sent to the user
		if (VerifyRxOrderEmail.equalsIgnoreCase("Yes")) {
		    String RxEmailLink = "//*[contains(text(),'Order Confirmation Details')]~XPATH";
		    // Modified for PSC and Rx mail verification
		    if (!isElementPresentVerifyClick(RxEmailLink, browser)) {
			throw new Exception("Not able to click on Rx Order Confirmation Email");
		    }
		    List<WebElement> RxOrderElements = browser.findElements(By.xpath("//*[contains(text(),'Prescription Order #')]"));
		    for (int j = 0; j < RxOrderNumber.length; j++) {
			boolean isOrderIDFound = false;
			if (RxOrderNumber[j] != null) {
			    for (int k = 0; k < RxOrderElements.size(); k++) {
				if (RxOrderElements.get(k).getText().toUpperCase().contains(RxOrderNumber[j])) {
				    isOrderIDFound = true;
				    break;
				}
			    }
			    if (!isOrderIDFound) {
				messagesMap.put("Yahoo mail, Order verification", "Order Number is not Found " + RxOrderNumber[j]);
				status = WARNING;
			    }
			}
		    }
		}
		// New Code Ended--SIVA
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to check the credit card page error message validation
     * 
     * @Input -
     * @author - Thangaraj R
     * @Created -26-March-13
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void creditcardPageErrorValidation(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String UpdateCreditCardDetails_LNK = "a[title='Edit payment information']~CSS";
	String CardType_LST = "select[id='creditcardtype']~CSS";
	String CardNumber_TXT = "//input[@id='credit_card_number' or @id='ccno']~XPATH";
	String ExpirationMonth_LST = "//select[@id='expdate' or @id='exp_month']~XPATH";
	String ExpirationYear_LST = "//select[@id='yr1' or @id='exp_year' or @id='yr']~XPATH";
	String Continue_BTN = "input[title*='Continue']~CSS"; // SIMEON -
	// 8/28/13 - Added
	// '*'
	String NewCreditCard_RADIO = "//input[@id='charge_cc' or @id='newcc' or @id='ccnew']~XPATH";
	String ErrorTypeOfCard_TXT = "//p[contains(text(),'Please check the Credit Card Type')]";
	String ErrorExpired_TXT = "//p[contains(text(),'Please check the Credit Card Expiry Date')]";
	String cardType = null;
	String cardNumber = null;
	String expireMonth = null;
	String expireYear = null;
	String ValidationType = null;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    ValidationType = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ValidationType");
	    cardType = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "CardType");
	    cardNumber = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "CardNumber");
	    expireMonth = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ExpireMonth");
	    expireYear = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ExpireYear");

	    // verify the UI in crdit card page
	    if (!isElementPresentVerifyClick(UpdateCreditCardDetails_LNK, browser)) {
		throw new Exception("Not able to click on Edit credit card Button");
	    }
	    getElementByProperty(NewCreditCard_RADIO, browser).click();
	    selectByVisibleText(CardType_LST, cardType, browser);
	    clearAndEnterText(CardNumber_TXT, cardNumber, browser);
	    selectByVisibleText(ExpirationMonth_LST, expireMonth, browser);
	    selectByVisibleText(ExpirationYear_LST, expireYear, browser);

	    if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
		throw new Exception("Not able to click on continue Button");
	    }
	    if (ValidationType.equalsIgnoreCase("CardType")) {
		if (!isElementPresentVerification(ErrorTypeOfCard_TXT, browser)) {
		    messagesMap.put("Expected Target page", "Error for type of card id is not displayed");
		    status = WARNING;
		}
	    } else if (ValidationType.equalsIgnoreCase("ExpiredCreditCard")) {
		if (!isElementPresentVerification(ErrorExpired_TXT, browser)) {
		    messagesMap.put("Expected Target page", "Error for Expired credit card is not displayed");
		    status = WARNING;
		}
	    }

	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to save numbr of Cart Items exits in Cart using top
     *          right Cart Box
     * @Input -
     * @author - Siva
     * @Created -17-APR-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void savenoOfCartItemsfromCartBox(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean) {
	String status = PASS;
	String CartItemscount_ELM = "//span[@id='cart-count']/a/strong~XPATH";
	int ItemscountinCart = 0;
	Map<String, String> messagesMap = null;
	Map<String, String> sharedProperties = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    sharedProperties = scenarioBean.getSharedStepProperties();
	    if (sharedProperties == null) {
		sharedProperties = new HashMap<String, String>();
		scenarioBean.setSharedStepProperties(sharedProperties);
	    }
	    if (isElementPresentVerification(CartItemscount_ELM, browser)) {
		ItemscountinCart = Integer.parseInt(getElementByProperty(CartItemscount_ELM, browser).getText().split("\\(")[1].split("\\)")[0].trim());
	    } else {
		ItemscountinCart = 0;
	    }
	    sharedProperties.put("NoofCartProducts", String.valueOf(ItemscountinCart));

	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to Validate Cart Items Count in the top Right Corner
     *          based on no of items in Cart
     * @Input -
     * @author - Siva
     * @Created -17-APR-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void validateCartItemsIncrementorDecrementCountinCartBox(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String CartItemscount_ELM = "//input[@title='Quantity Box']~XPATH"; // SIMEON
	// -
	// 8/29/13
	// -
	// Fixed
	String QuantityField_TXT = "input[alt='Quantity']";
	String Remove_LNK = "a[title='Remove']~CSS";
	int CartItemsCountBeforeAction = 0, CartItemsCountAfterAction = 0;
	Map<String, String> messagesMap = null;
	Map<String, String> getSharedProperties = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    getSharedProperties = scenarioBean.getSharedStepProperties();
	    CartItemsCountBeforeAction = Integer.parseInt(getSharedProperties.get("NoofCartProducts"));

	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		if (dataMap.get("CartIncrementerVerification").get(i).equalsIgnoreCase("Yes")) {
		    int ItemscountinCart = 0;
		    CartItemsCountAfterAction = Integer.parseInt(getElementByProperty(CartItemscount_ELM, browser).getAttribute("value"));
		    if ((CartItemsCountAfterAction - CartItemsCountBeforeAction) != 1) {
			messagesMap.put("Cart Incrementer", "Count is not incremented by one after removing one proudct");
			status = WARNING;
		    }
		    List<WebElement> noofQuantityFieldsinCart = browser.findElements(By.cssSelector(QuantityField_TXT));
		    for (int j = 0; j < noofQuantityFieldsinCart.size(); j++) {
			ItemscountinCart = ItemscountinCart + (Integer.parseInt(noofQuantityFieldsinCart.get(i).getAttribute("value")));
		    }
		    if (ItemscountinCart != CartItemsCountAfterAction) {
			messagesMap.put("Cart items Count", "Count displayed in the top right cartner is mismatching with items count in Cart");
			status = WARNING;
		    }
		}
		if (dataMap.get("CartDecrementerVerification").get(i).equalsIgnoreCase("Yes")) {
		    int ItemscountinCart = 0;
		    CartItemsCountBeforeAction = Integer.parseInt(getElementByProperty(CartItemscount_ELM, browser).getAttribute("value"));
		    if (!isElementPresentVerifyClick(Remove_LNK, browser)) {
			throw new Exception("Not able to Click on Remove Link");
		    }
		    if (isElementPresentVerification(CartItemscount_ELM, browser)) {
			CartItemsCountAfterAction = Integer.parseInt(getElementByProperty(CartItemscount_ELM, browser).getText().split("\\(")[1].split("\\)")[0].trim());
		    } else {
			CartItemsCountAfterAction = 0;
		    }
		    if ((CartItemsCountBeforeAction - CartItemsCountAfterAction) != 1) {
			messagesMap.put("Cart Decrementer", "Count is not reduced by one after removing one proudct");
			status = WARNING;
		    }
		    List<WebElement> noofQuantityFieldsinCart = browser.findElements(By.cssSelector(QuantityField_TXT));
		    for (int j = 0; j < noofQuantityFieldsinCart.size(); j++) {
			ItemscountinCart = ItemscountinCart + (Integer.parseInt(noofQuantityFieldsinCart.get(i).getAttribute("value")));
		    }
		    if (ItemscountinCart != CartItemsCountAfterAction) {
			messagesMap.put("Cart items Count", "Count displayed in the top right cartner is mismatching with items count in Cart");
			status = WARNING;
		    }
		}
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to Validate Previous items from Shopping Cart
     * @Input -
     * @author - Siva
     * @Created -19-APR-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void validatePreviousAddedItesminCart(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String Prescriptionsheader_ELM = "//th[contains(text(),'Prescriptions')]~XPATH";
	String ActionsHeader_ELM = "//th[contains(text(),'Actions')]~XPATH";
	String ContactLensHeader_ELM = "//th[contains(text(),'Contact Lenses')]~XPATH";
	String ContactLensShipFreeMessage_ELM = "//*[contains(text(),'Ship to you - FREE')]~XPATH";
	String ProductInformationHeader_ELM = "//th[contains(text(),'Product Information')]~XPATH";
	String PSCProductLinkName_LNK = "//*[contains(text(),'Prescription Savings Club')]~XPATH";
	String ProductsCartTable = "//table[contains(@class,'cartProdTable')]/tbody";
	String RxinCart = null, CLinCart = null, DLinCart = null, PSCinCart = null, InputFileName = null, SheetName = null, RowID = null, ColumnName = null, ProductID = null;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		// Get Data From Excel
		RxinCart = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "RxinCart");
		CLinCart = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "CLinCart");
		DLinCart = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "DLinCart");
		PSCinCart = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "PSCinCart");
		InputFileName = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "InputFileName");
		SheetName = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "SheetName");
		RowID = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "RowID");
		ColumnName = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "ColumnName");
		ProductID = getTestData(InputFileName, SheetName, RowID, ColumnName);

		if (RxinCart != null && RxinCart.equalsIgnoreCase("No")) {
		    if (isElementPresentVerification(Prescriptionsheader_ELM, browser) || isElementPresentVerification(ActionsHeader_ELM, browser)) {
			messagesMap.put("Rxs in Cart", "Rxs items in Cart should not be displayed");
			status = WARNING;
		    }
		}
		if (CLinCart != null && CLinCart.equalsIgnoreCase("No")) {
		    if (isElementPresentVerification(ContactLensHeader_ELM, browser) || isElementPresentVerification(ContactLensShipFreeMessage_ELM, browser)) {
			messagesMap.put("CL in Cart", "CL items in Cart should not be displayed");
			status = WARNING;
		    }
		}
		if (DLinCart != null && DLinCart.equalsIgnoreCase("No")) {
		    if (isElementPresentVerification(ProductInformationHeader_ELM, browser)) {
			messagesMap.put("Ss item in Cart", "SS items in Cart should not be displayed");
			status = WARNING;
		    }
		}
		if (PSCinCart != null && PSCinCart.equalsIgnoreCase("No")) {
		    if (isElementPresentVerification(PSCProductLinkName_LNK, browser)) {
			messagesMap.put("PSC in Cart", "PSC item in Cart shuould not be displayed");
			status = WARNING;
		    }
		}
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to Validate Pricing Rule in Shopping Cart, Order Review
     *          and Order Confirmation Pages
     * @Input -
     * @author - Siva
     * @Created -29-APR-2013
     * @Modified By -YGNASH
     * @Modified Date -5 JUN 2013
     ************************************************************* 
     */
    public static void validatePricingRuleConfigurationinCart(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String Products_Table = "//table[contains(@class,'sddCartTable')]/tbody~XPATH";
	String ProductID = null, BABGFreeMessage = null, validatePrice = null, BOGOLEPMessage = null, BOGOMessage = null;
	boolean flag = false;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		// Get Data From Excel
		ProductID = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "Keyword");
		BABGFreeMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BABGFreeMessage");
		BOGOLEPMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOLEPMessage");
		BOGOMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOMessage");
		validatePrice = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "validatePrice");
		if (isElementPresentVerification(Products_Table, browser)) {
		    List<WebElement> dlTableRows = getElementByProperty(Products_Table, browser).findElements(By.tagName("tr"));

		    for (int row = 4; row <= dlTableRows.size(); row = row + 4) {

			String DLitemProdID = browser.findElement(By.xpath("//table[contains(@class,'sddCartTable')]/tbody/tr[" + (row - 1) + "]/td/div/div[2]/p/strong/a")).getAttribute("href")
				.split("id=")[1].split("&")[0];
			if (DLitemProdID.equalsIgnoreCase(ProductID)) {
			    flag = true;
			    if (validatePrice != null && validatePrice.equalsIgnoreCase("Yes")) {
				WebElement ProductPriceColumn = browser.findElement(By.xpath("//table[contains(@class,'sddCartTable')]/tbody/tr[" + (row - 1) + "]/td[3]"));
				// List<WebElement> priceElementsinPriceColumn =
				// ProductPriceColumn.findElements(By.xpath("//strong[contains(text(),'$')]"));
				List<WebElement> priceElementsinPriceColumn = ProductPriceColumn.findElements(By.tagName("strong"));
				String PriceoftheProduct = priceElementsinPriceColumn.get(priceElementsinPriceColumn.size() - 1).getText().trim();
				if (PriceoftheProduct.contains("/")) {
				    String[] PriceElements = PriceoftheProduct.split("/");
				    PriceoftheProduct = PriceElements[PriceElements.length - 1];
				}
				String PriceoftheProductinTotalcolumn = browser.findElement(By.xpath("//table[contains(@class,'sddCartTable')]/tbody/tr[" + (row - 1) + "]/td[5]/h3")).getText().trim();
				if (!PriceoftheProduct.equals(PriceoftheProductinTotalcolumn)) {
				    messagesMap.put("Price Total", "Total is mismatching");
				    status = WARNING;
				}
			    }
			    if (BABGFreeMessage != null & BABGFreeMessage.equalsIgnoreCase("Yes")) {
				String TotalColumnText = browser.findElement(By.xpath("//table[contains(@class,'sddCartTable')]/tbody/tr[" + (row - 1) + "]/td[5]/h3")).getText();
				if (!TotalColumnText.contains("1  item  FREE")) {
				    messagesMap.put("BABG Message", "Not able to Find BAGB message");
				    status = WARNING;
				}
			    }
			    if (BOGOLEPMessage != null & BOGOLEPMessage.equalsIgnoreCase("Yes")) {
				// row = row+4; //MODIFIED BY YGNASH - ROW
				// CHANGE IN THE SHOPPING CART TABLE
				String TotalColumnText = browser.findElement(By.xpath("//table[contains(@class,'sddCartTable')]/tbody/tr[" + (row - 1) + "]/td[5]/h3[2]")).getText();
				if (!TotalColumnText.contains("1  item  50% OFF")) {

				    messagesMap.put("BOGOLEP Message", "Not able to Find BOGOLEP message");
				    status = WARNING;
				}
			    }
			    if (BOGOMessage != null & BOGOMessage.equalsIgnoreCase("Yes")) {
				// String TotalColumnText =
				// browser.findElement(By.xpath("//table[contains(@class,'cartProdTable')]/tbody/tr["
				// + row + "]/td[5]/h3")).getText();
				// Modified Since Price and Offer message is
				// displayed Seperately.
				// Modified by : FYROSE Date : 8 - May - 2013
				String TotalColumnText = browser.findElement(By.xpath("//table[contains(@class,'sddCartTable')]/tbody/tr[" + (row - 1) + "]/td[5]")).getText();
				if (!TotalColumnText.contains("1  item  FREE")) {
				    messagesMap.put("BOGO Message", "Not able to Find BOGO message");
				    status = WARNING;
				}
			    }
			}
		    }
		} else {
		    messagesMap.put("Product Table", "Table was not Found");
		    status = WARNING;

		}
		if (!flag) {
		    messagesMap.put("Product in Cart", "Required Product was not found in Cart");
		    status = WARNING;
		}
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to Validate Pricing Rule in Order Review Order Page
     * @Input -
     * @author - Siva
     * @Created -30-APR-2013
     * @Modified By -YGNASH
     * @Modified Date -5 JUN 2013
     ************************************************************* 
     */
    public static void validatePricingRuleConfigurationinOrderReviewPage(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String BABGFreeMessage = null, validatePrice = null, BOGOLEPMessage = null, BOGOMessage = null, ProductTitle = null;
	boolean flag = false;
	String ProductDivContainer = "//div[@id='leftNavShippingInfo']~XPATH";
	String[] PriceoftheProduct = null;
	String[] PriceinPricecolumn = null;
	String PriceoftheProductinPricecolumn = null;
	String PriceoftheProductinTotalcolumn = null;
	String[] Price = null;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		// Get Data From Excel
		BABGFreeMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BABGFreeMessage");
		BOGOLEPMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOLEPMessage");
		BOGOMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOMessage");
		validatePrice = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "validatePrice");
		ProductTitle = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "Keyword2");
		List<WebElement> productDivs = getElementByProperty(ProductDivContainer, browser).findElements(
			By.xpath("//div[contains(@class,'shipMthdStrokeClr')]/div[contains(@class,'padMargin')]"));
		for (int count = 0; count < productDivs.size(); count++) {
		    String ExtractedText = productDivs.get(count).getText().replaceAll(" ", "");
		    String ExpectedText = ProductTitle.replaceAll(" ", "").trim();
		    if (ExtractedText.contains(ExpectedText)) {
			if (validatePrice != null && validatePrice.equalsIgnoreCase("Yes")) {
			    // SPLIT TO GET PRICE OF THE PRODUCT IN PRICE COLUMN
			    // AND TOTAL COLUMN SEPARATELY
			    PriceoftheProduct = productDivs.get(count).getText().split("\\$");
			    // TO GET PRICE ALONE,SPLITING AGAIN FROM OTHER TEXT
			    PriceinPricecolumn = PriceoftheProduct[1].split(" ");
			    // FOR BOGOLEV PRODUCT,TO SPLIT 'BUY' TEXT FROM
			    // PRICE IN PRICE COLUMN
			    if (PriceinPricecolumn[0].contains("Buy")) {
				Price = PriceinPricecolumn[0].split("Buy");
				PriceoftheProductinPricecolumn = Price[0].trim();
			    }
			    // FOR BAGB PRODUCT,TO SPLIT 'COMBINE' TEXT FROM
			    // PRICE IN PRICE COLUMN
			    else if (PriceinPricecolumn[0].contains("Combine")) {

				Price = PriceinPricecolumn[0].split("Combine");
				PriceoftheProductinPricecolumn = Price[0].trim();
			    } else {
				PriceoftheProductinPricecolumn = PriceinPricecolumn[0].trim();
			    }
			    // GIVES THE PRICE OF THE PRODUCT IN TOTAL COLUMN
			    PriceoftheProductinTotalcolumn = PriceoftheProduct[2];
			    // COMPARES THE PRICE OF THE PRIMARY PRODUCT IS SAME
			    // IN BOTH PRICE AND TOTAL COLUMN
			    if (!PriceoftheProductinPricecolumn.equals(PriceoftheProductinTotalcolumn)) {
				messagesMap.put("Price Total", "Total is mismatching");
				status = WARNING;
			    }
			}
			if (BOGOLEPMessage != null & BOGOLEPMessage.equalsIgnoreCase("Yes")) {
			    if (!productDivs.get(count).getText().contains("1  item  50% OFF")) {
				messagesMap.put("BOGOLEP Message", "Not able to Find BOGOLEP message");
				status = WARNING;
			    }
			}
			if (BABGFreeMessage != null & BABGFreeMessage.equalsIgnoreCase("Yes")) {
			    if (!productDivs.get(count).getText().contains("1  item  FREE")) {
				messagesMap.put("BABG Message", "Not able to Find BAGB message");
				status = WARNING;
			    }
			}
			if (BOGOMessage != null & BOGOMessage.equalsIgnoreCase("Yes")) {
			    if (!productDivs.get(count).getText().contains("1  item  FREE")) {
				messagesMap.put("BOGO Message", "Not able to Find BOGO message");
				status = WARNING;
			    }
			}
			break;
		    }
		}
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to Validate Pricing Rule in Order Confirmation Page
     * @Input -
     * @author - Siva
     * @Created -30-APR-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void validatePricingRuleConfigurationinOrderConfirmationPage(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String Products_DIV = "//div[contains(@class,'shipMthdStrokeClr')]~XPATH";
	String ProductID = null, BABGFreeMessage = null, BOGOLEPMessage = null, BOGOMessage = null;
	boolean flag = false;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		// Get Data From Excel
		ProductID = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "Keyword");
		BABGFreeMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BABGFreeMessage");
		BOGOLEPMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOLEPMessage");
		BOGOMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOMessage");
		if (isElementPresentVerification(Products_DIV, browser)) {
		    List<WebElement> dlproductdivs = getElementByProperty(Products_DIV, browser)
			    .findElements(By.xpath("//div[contains(@class,'shipMthdStrokeClr')]/div[contains(@class,'padMargin')]"));

		    for (int divnumber = 1; divnumber <= dlproductdivs.size(); divnumber = divnumber + 2) {
			String DLitemProdID = browser.findElement(By.xpath("//div[contains(@class,'shipMthdStrokeClr')]/div[" + divnumber + "]/div/div/a")).getAttribute("href").split("&id=")[1]
				.trim();
			if (DLitemProdID.equalsIgnoreCase(ProductID)) {
			    flag = true;
			    if (BABGFreeMessage != null & BABGFreeMessage.equalsIgnoreCase("Yes")) {
				String TotalColumnText = browser.findElement(By.xpath("//div[contains(@class,'shipMthdStrokeClr')]/div[" + divnumber + "]/div[3]")).getText().trim();
				if (!TotalColumnText.contains("1  item  FREE")) {
				    messagesMap.put("BABG Message", "Not able to Find BAGB message");
				    status = WARNING;
				}
			    }
			    if (BOGOLEPMessage != null & BOGOLEPMessage.equalsIgnoreCase("Yes")) {
				String TotalColumnText = browser.findElement(By.xpath("//div[contains(@class,'shipMthdStrokeClr')]/div[" + divnumber + "]/div[3]")).getText().trim();
				if (!TotalColumnText.contains("1  item  50% OFF")) {
				    messagesMap.put("BOGOLEP Message", "Not able to Find BOGOLEP message");
				    status = WARNING;
				}
			    }
			    if (BOGOMessage != null & BOGOMessage.equalsIgnoreCase("Yes")) {
				String TotalColumnText = browser.findElement(By.xpath("//div[contains(@class,'shipMthdStrokeClr')]/div[" + divnumber + "]/div[3]")).getText().trim();
				if (!TotalColumnText.contains("1  item  FREE")) {
				    messagesMap.put("BOGO Message", "Not able to Find BOGO message");
				    status = WARNING;
				}
			    }
			}
		    }
		} else {
		    messagesMap.put("Product Divison", "Divison was not Found");
		    status = WARNING;

		}
		if (!flag) {
		    messagesMap.put("Product in Order Confirmation Page", "Order Confirmation Page");
		    status = WARNING;
		}
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to Validate Non-Existence of Promo message in Shopping
     *          cart,Order review page and Order confirmation page
     * @Input -
     * @author -Ygnash
     * @Created -28 May 2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void verifynonexistenceofpromomessage(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	Map<String, String> messagesMap = null;
	String ProductID = null, BABGFreeMessage = null, BOGOLEPMessage = null;
	int row;
	String PromoMessage = null;
	String Products_Table = "//table[contains(@class,'cartProdTable')]/tbody~XPATH";
	String TotalColumn = "//td[@class='totalCartProd']/h3";
	String ShoppingCart_ELM = "//h2[contains(text(),'Shopping Cart')]~XPATH";
	String OrderReview_ELM = "//p[contains(text(),'Order review')]~XPATH";
	String OrderConfirmation_ELM = "//p[contains(text(),'Order complete')]~XPATH";
	String ProductSummary_DIV = "//div[contains(@class,'shipMthdStroke')]~XPATH";
	String Remove_LNK = "a[title='Remove']~CSS";
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		// Get Data From Excel
		ProductID = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "Keyword2");
		BABGFreeMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BABGFreeMessage");
		BOGOLEPMessage = getTestData(dataMap.get("InputFileName").get(i), dataMap.get("SheetName").get(i), dataMap.get("RowId").get(i), "BOGOLEPMessage");
		// TO REMOVE THE PRIMARY PRODUCT FROM SHOPPING CART
		if (isElementPresentVerification(ShoppingCart_ELM, browser)) {
		    if (isElementPresentVerification(Products_Table, browser)) {
			List<WebElement> dlTableRows = getElementByProperty(Products_Table, browser).findElements(By.tagName("tr"));
			for (row = 4; row <= dlTableRows.size(); row = row + 4) {
			    String DLitemProdTitle = browser.findElement(By.xpath("//table[contains(@class,'cartProdTable')]/tbody/tr[" + row + "]/td")).getText();
			    if (DLitemProdTitle.contains(ProductID)) {
				if (!isElementPresentVerifyClick(Remove_LNK, browser)) {
				    throw new Exception("Remove Link not found for the Primary product");
				}
				break;
			    }
			}
		    }
		}
		// TO CHECK WHETHER PROMO MESSAGE IS NOT DISPLAYED IN CART AFTER
		// REMOVAL OF PRIMARY PRODUCT
		if (isElementPresentVerification(ShoppingCart_ELM, browser)) {
		    if (BABGFreeMessage != null & BABGFreeMessage.equalsIgnoreCase("Yes")) {
			PromoMessage = getElementByProperty(TotalColumn, browser).getText();
			if (PromoMessage.equalsIgnoreCase("1  item  FREE")) {
			    messagesMap.put("BABG Message", "BAGB message is present.Primary product not removed");
			    status = WARNING;
			}
		    }
		    if (BOGOLEPMessage != null & BOGOLEPMessage.equalsIgnoreCase("Yes")) {
			PromoMessage = getElementByProperty(TotalColumn, browser).getText();
			if (!PromoMessage.contains("1  item  50% OFF")) {

			    messagesMap.put("BOGOLEP Message", "BOGOLEP message is present.Primary product not removed");
			    status = WARNING;
			}

		    }
		}
		// TO CHECK WHETHER PROMO MESSAGE IS NOT DISPLAYED IN ORDER
		// REVIEW AND ORDER CONFRIMATION PAGE AFTER REMOVAL OF PRIMARY
		// PRODUCT
		else if ((isElementPresentVerification(OrderReview_ELM, browser)) || (isElementPresentVerification(OrderConfirmation_ELM, browser))) {
		    if (BABGFreeMessage != null & BABGFreeMessage.equalsIgnoreCase("Yes")) {
			PromoMessage = getElementByProperty(ProductSummary_DIV, browser).getText();
			if (PromoMessage.equalsIgnoreCase("1  item  FREE")) {
			    messagesMap.put("BABG Message", "BAGB message is present.Primary product not removed");
			    status = WARNING;
			}
		    }
		    if (BOGOLEPMessage != null & BOGOLEPMessage.equalsIgnoreCase("Yes")) {
			PromoMessage = getElementByProperty(ProductSummary_DIV, browser).getText();
			if (!PromoMessage.contains("1  item  50% OFF")) {
			    messagesMap.put("BOGOLEP Message", "BOGOLEP message is present.Primary product not removed");
			    status = WARNING;
			}

		    }
		} else {
		    messagesMap.put("verifynonexistenceofpromomessage", "Not found any of the pages");
		    status = WARNING;
		}
	    }
	} catch (Exception e) {
	    status = WARNING;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to to apply Promotion in shopping cart and verfy
     *          checkout pages copy
     * @author - Hasan javeed
     * @Created - 03-June-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void applyPromotionAndVerifyCheckoutPages(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String CouponCode_TXT = "//input[@id='ccode']~XPATH";
	String ApplyCode_BTN = "//input[@id='applyCouponAction']~XPATH";
	String SucessRight_IMG = "//p[@class='float_right success_new']~XPATH";
	String PromotionApplied_TEXT = "//*[contains(text(),'Promotion(s) Applied:')]~XPATH";
	String PromotionApplied = "//strong[contains(text(),'Promotion(s) applied:')]~XPATH";
	String PromotionRemove_LNK = "//a[contains(@href,'/store/promotions/frags/couponclaim_fg_sdd.jsp?')]~XPATH";
	String PromotionSuccessMessage_ELM = "//p[contains(text(),'Your promotion code has been applied successfully!')]~XPATH";
	String CouponName = null, TargetPage = null, RemoveExistingCoupon = null;

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    CouponName = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "CouponName");
	    RemoveExistingCoupon = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "RemoveExistingCoupon");
	    TargetPage = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "TargetPage");
	    if (RemoveExistingCoupon != null && RemoveExistingCoupon.equalsIgnoreCase("Yes")) {
		if (isElementPresentVerification(PromotionRemove_LNK, browser)) {
		    if (!isElementPresentVerifyClick(PromotionRemove_LNK, browser)) {
			throw new Exception("Not able to Click on Remove link Promotions link");
		    }
		}
	    }
	    if (TargetPage.equalsIgnoreCase("ShoppingCart")) {
		if (!clearAndEnterText(CouponCode_TXT, CouponName, browser)) {
		    messagesMap.put("Applying coupon code", "Coupon code is not getting applied in shoping cart");
		    status = WARNING;
		}
		if (!isElementPresentVerifyClick(ApplyCode_BTN, browser)) {
		    messagesMap.put("Applying coupon code", "Apply Coupon code button is not clickable in shoping cart");
		    status = WARNING;
		}
		if (!isElementPresentVerification(PromotionSuccessMessage_ELM, browser)) {
		    messagesMap.put("Promotion Success Message", "Message is not displaying");
		    status = WARNING;
		}
		if (!isElementPresentVerification(SucessRight_IMG, browser)) {
		    messagesMap.put("Applying coupon code", "Sucess symbol is not getting displayed in shoping cart after applying coupon");
		    status = WARNING;
		}
		if (!isElementPresentVerification(PromotionApplied_TEXT, browser)) {
		    messagesMap.put("Applying coupon code", "Promotion applied text is not getting displayed in shoping cart after applying coupon");
		    status = WARNING;
		}
	    } else if (TargetPage.equalsIgnoreCase("ShippingInformation")) {
		if (!isElementPresentVerification(PromotionApplied, browser)) {
		    messagesMap.put("Pomotion applied", "Promotion Applied text is missing in Right Navigation in shipping information");
		    status = WARNING;
		}
	    } else if (TargetPage.equalsIgnoreCase("ShippingMethod")) {
		if (!isElementPresentVerification(PromotionApplied, browser)) {
		    messagesMap.put("Pomotion applied", "Promotion Applied text is missing in Right Navigation in shipping method");
		    status = WARNING;
		}
	    } else if (TargetPage.equalsIgnoreCase("PaymentInformation")) {
		if (!isElementPresentVerification(PromotionApplied, browser)) {
		    messagesMap.put("Pomotion applied", "Promotion Applied text is missing in Right Navigation in payment information");
		    status = WARNING;
		}
	    } else if (TargetPage.equalsIgnoreCase("ReviewOrder")) {
		if (!isElementPresentVerification(PromotionApplied, browser)) {
		    messagesMap.put("Pomotion applied", "Promotion Applied text is missing in Right Navigation in Review order");
		    status = WARNING;
		}
	    } else if (TargetPage.equalsIgnoreCase("OrderConfirmation")) {
		if (!isElementPresentVerification(PromotionApplied, browser)) {
		    messagesMap.put("Pomotion applied", "Promotion Applied text is missing in Right Navigation in Order confirmation");
		    status = WARNING;
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method verify blue box and exception messages in Shipping info
     * @author - Hasan javeed
     * @Created - 16-July-2013
     * @Modified By -Hasan
     * @Modified Date -21-Aug-2013
     ************************************************************* 
     */
    public static void verifyBlueboxAndErrorMessages(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;

	String ShippingHeader_TXT = "//h3[contains(text(),'Shipping')]~XPATH";
	String Shippinginfo_TXT = "//p[contains(text(),'Shipping Information')]~XPATH";
	String ShipTo_TXT = "//h3[contains(text(),'Ship to')]~XPATH";
	String ChangeAddress_BTN = "//input[@title='Change Address']~XPATH";
	String SavePreferred_BTN = "//input[@title='Save as preferred']~XPATH";
	String PreferredAddress_TXT = "//div[contains(text(),'Preferred address')]~XPATH";
	String EditAddres_BTN = "//input[@title='Edit this address']~XPATH";
	String SavePreferred_TXT = "//div[contains(text(),'Preferred')]~XPATH";
	String MaxAddressError_ELM = "//p[@class= 'AddBkFullError']~XPATH";
	String FirstNameError_TXT = "//p[contains(text(),'Please enter the First Name')]~XPATH";
	String LastNameError_TXT = "//p[contains(text(),'Please enter the Last Name')]~XPATH";
	String StreetAddressError_TXT = "//p[contains(text(),'Please enter the Street Address')]~XPATH";
	String CityError_TXT = "//p[contains(text(),'Please enter the City')]~XPATH";
	String StateError_TXT = "//p[contains(text(),'Please select the State')]~XPATH";
	String ZipCodeError_TXT = "//p[contains(text(),'Please enter the valid ZIP Code')]~XPATH";
	String SelectAddressHome_BTN = "//*[@id='addressCardSection']/div[1]/input~XPATH";
	String SelectAddressShip_BTN = "//*[@id='addressCardSection']/div[2]/input~XPATH";

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }

	    if (dataMap.get("Header").get(0).equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerification(ShippingHeader_TXT, browser)) {
		    messagesMap.put("shipping address", "Shipping header is wrongly displayed in progress bar");
		    status = WARNING;
		}
		if (!isElementPresentVerification(Shippinginfo_TXT, browser)) {
		    messagesMap.put("shipping address", "Shipping information text is wrongly displayed");
		    status = WARNING;
		}
	    }
	    if (dataMap.get("ChangeAddress").get(0).equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerification(ShipTo_TXT, browser)) {
		    messagesMap.put("shipping address", "not able to see ship to test in blue box header");
		    status = WARNING;
		}
		if (!isElementPresentVerification(ChangeAddress_BTN, browser)) {
		    messagesMap.put("shipping address", "not able to see change address button in blue box header");
		    status = WARNING;
		}
	    }
	    if (dataMap.get("EditThisAddress").get(0).equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerification(EditAddres_BTN, browser)) {
		    messagesMap.put("shipping address", "not able to see edit address button in blue box header");
		    status = WARNING;
		}
	    }
	    if (dataMap.get("SaveAsPrefered").get(0).equalsIgnoreCase("Yes")) {
		if (isElementPresentVerification(PreferredAddress_TXT, browser)) {
		} else if (isElementPresentVerification(SavePreferred_BTN, browser)) {
		    if (!isElementPresentVerifyClick(SavePreferred_BTN, browser)) {
			messagesMap.put("shipping address", "not able to click on save prefereed address button in blue box header");
			status = WARNING;
		    }
		    if (!isElementPresentVerification(PreferredAddress_TXT, browser)) {
			messagesMap.put("shipping address", "prefereed address text is not displayed in Address Book");
			status = WARNING;
		    }
		}
	    }
	    if (dataMap.get("SaveAsPrefered").get(0).equalsIgnoreCase("AB")) {
		if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
		    messagesMap.put("shipping address", "not able to click on change address button in blue box header");
		    status = WARNING;
		}
		// Thread.sleep(1000);
		if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
		    messagesMap.put("shipping address", "not able to click on Select address button in Address Book");
		    status = WARNING;
		}
		if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
		    messagesMap.put("shipping address", "not able to click on change address button in blue box header");
		    status = WARNING;
		}
		if (!isElementPresentVerification(SavePreferred_TXT, browser)) {
		    messagesMap.put("shipping address", "prefereed address text is not displayed in blue box header");
		    status = WARNING;
		}
		if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
		    messagesMap.put("shipping address", "not able to click on Select address button in Address Book");
		    status = WARNING;
		}
	    }
	    if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("MaxAddresses")) {
		if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
		    throw new Exception("shipping Address: Not able to click on change address button in Shipping Information Page.");
		}
		if (!isElementPresentVerification(MaxAddressError_ELM, browser)) {
		    messagesMap.put("Address Book Full ", "Your addresss book full Error Message is not being displayed");
		    status = WARNING;
		}
	    } else if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("FirstName")) {
		if (!isElementPresentVerification(FirstNameError_TXT, browser)) {
		    messagesMap.put("Shipping Information", "First Name Error Message is not being displayed");
		    status = WARNING;
		}
	    } else if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("LastName")) {
		if (!isElementPresentVerification(LastNameError_TXT, browser)) {
		    messagesMap.put("Shipping Information", "Last Name Error Message is not being displayed");
		    status = WARNING;
		}
	    } else if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("StreetAddress")) {
		if (!isElementPresentVerification(StreetAddressError_TXT, browser)) {
		    messagesMap.put("Shipping Information", "Street Address Error Message is not being displayed");
		    status = WARNING;
		}
	    } else if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("City")) {
		if (!isElementPresentVerification(CityError_TXT, browser)) {
		    messagesMap.put("Shipping Information", "City Error Message is not being displayed");
		    status = WARNING;
		}
	    } else if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("State")) {
		if (!isElementPresentVerification(StateError_TXT, browser)) {
		    messagesMap.put("Shipping Information", "State Error Message is not being displayed");
		    status = WARNING;
		}
	    } else if (dataMap.get("ErrorValidation").get(0).equalsIgnoreCase("ZipCode")) {
		if (!isElementPresentVerification(ZipCodeError_TXT, browser)) {
		    messagesMap.put("Shipping Information", "ZipCode Error Message is not being displayed");
		    status = WARNING;
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to save the Order Summary Details
     * @author - Siva
     * @Created - 12-SEP-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void saveOrderSummaryDetails(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;

	String SalesTax_ELM = "//p[contains(@class,'salesTaxText')]~XPATH";
	String Total_ELM = "//div[contains(@class,'totalPrc')]~XPATH";
	float SalesTax = 0, OrderTotal = 0;
	Map<String, String> messagesMap = null;
	Map<String, String> sharedProperties = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    sharedProperties = scenarioBean.getSharedStepProperties();
	    if (sharedProperties == null) {
		sharedProperties = new HashMap<String, String>();
		scenarioBean.setSharedStepProperties(sharedProperties);
	    }
	    String FulfillmentType = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "FulfillmentType");
	    String TotalQuantity = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "TotalQuantity");
	    String NoofFulfillmentItems = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "NoofFulfillmentItems");
	    String fullOrderTax = getElementByProperty(SalesTax_ELM, browser).getText().replace("$", "").trim();
	    String fullOrderTotal = getElementByProperty(Total_ELM, browser).getText().replace("$", "").replaceAll(",", "").trim();
	    if (FulfillmentType != null && FulfillmentType.equalsIgnoreCase("Partial")) {
		int intNoofFulfillmentItems = Integer.parseInt(NoofFulfillmentItems);
		float taxPerOneItem = (Float.parseFloat(fullOrderTax)) / (Float.parseFloat(TotalQuantity));
		SalesTax = intNoofFulfillmentItems * taxPerOneItem;
		float totalPerOneItem = (Float.parseFloat(fullOrderTotal)) / (Float.parseFloat(TotalQuantity));
		OrderTotal = intNoofFulfillmentItems * totalPerOneItem;
		DecimalFormat decimalFormat = new DecimalFormat("#.##");
		SalesTax = Float.parseFloat(decimalFormat.format(SalesTax));
		OrderTotal = Float.parseFloat(decimalFormat.format(OrderTotal));
	    } else {
		SalesTax = Float.parseFloat(fullOrderTax);
		OrderTotal = Float.parseFloat(fullOrderTotal);
	    }
	    sharedProperties.put("SalesTax", String.valueOf(SalesTax));
	    sharedProperties.put("OrderTotal", String.valueOf(OrderTotal));
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to verify address and shipping information in order
     *          summary page
     * @author - Ygnash
     * @Created - 30-SEP-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */

    public static void verifyShippingDetailsandAddressinOrderSummaryPage(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {

	String status = PASS;
	String AddressInOrderSummaryPage = "//div[@id='rightNav']/div/div[5]~XPATH";
	Map<String, String> messagesMap = null;
	Map<String, String> sharedProperties = scenarioBean.getSharedStepProperties();
	try {

	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    String Address_Verification_Flag = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "AddressVerificationFlag");
	    if (Address_Verification_Flag.equalsIgnoreCase("yes")) {
		if (isElementPresentVerification(AddressInOrderSummaryPage, browser)) {
		    String Address_OrderSummaryPage = getElementByProperty(AddressInOrderSummaryPage, browser).getText().trim();
		    String Shipping_Info_Page_Address = sharedProperties.get("Address_Shipping_Info_Page");
		    if (Address_OrderSummaryPage.equals(Shipping_Info_Page_Address)) {
			// Do nothing.Scenario Passed
		    } else {
			messagesMap.put("Order Summary Page", "Address of User does not match address in Shipping Information Page");
			status = WARNING;
		    }
		} else {
		    messagesMap.put("Order Summary Page", "Address of User is not displayed correctly");
		    status = WARNING;
		}

	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose - Method to Verify product shipping details and Alignments in
     *          various pages
     * @author - Fyrose Mohamed
     * @Created - 30-SEP-2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void checkdeliveryMessages(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String PSCShipping_DIV = "//p[contains(text(),'Processes in 10-14 business day(s)')]~XPATH";
	String CLMailShipping_DIV = "//p[contains(@class,'itemsArriveText')]~XPATH";
	String GiftPSCShipping_DIV = "//p[contains(text(),'Items arrive in 3-7 business days')]~XPATH";
	String DCCHShipping_DIV = "//p[contains(text(),'Items arrive in 2-5 business days')]~XPATH";
	String YahooContinue_LNK = "//a[contains(text(),'Continue')]~XPATH";
	String YahooRxSubject_LNK = "//span[contains(text(),'Your Walgreens.com Order Confirmation Details')]~XPATH";
	String YahooSSsubject_LNK = "//span[contains(text(),'Your Walgreens.com Order Details')]~XPATH";
	String YahooCLMailShipping_DIV = "//*[contains(text(),'Items arrive in 4 business days')]~XPATH";
	String YahooGiftPSCShipping_DIV = "//*[contains(text(),'Items arrive in 3-7 business days')]~XPATH";
	String YahooDCCHShipping_DIV = "//*[contains(text(),'Items arrive in 2-5 business days')]~XPATH";

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    // Write your code here
	    String pageoption = dataMap.get("PageOption").get(0);
	    String Checkval = dataMap.get("ProductCheck").get(0);

	    if (pageoption.equalsIgnoreCase("ShoppingCart")) {
		if (Checkval.equalsIgnoreCase("CheckPSCShipping")) {
		    if (!isElementPresentVerification(PSCShipping_DIV, browser)) {
			messagesMap.put("Shopping cart_PSC Item", "Processes in 10-14 business day(s) message not found in cart page");
			status = WARNING;
		    }
		}
	    } else if (pageoption.equalsIgnoreCase("OrderReview")) {
		if (Checkval.equalsIgnoreCase("CheckAll")) {
		    // CL Mail plan
		    if (!isElementPresentVerification(CLMailShipping_DIV, browser)) {
			messagesMap.put("OrderReview_CL Item", "Items arrive in 4 business days Message not found in order review Page");
			status = WARNING;
		    }
		    // PSC Giftcards
		    if (!isElementPresentVerification(GiftPSCShipping_DIV, browser)) {
			messagesMap.put("OrderReview_PSC Giftcards Item", "Items arrive in 3-7 business days Message not found in order review Page");
			status = WARNING;
		    }
		    // DC CH items
		    if (!isElementPresentVerification(DCCHShipping_DIV, browser)) {
			messagesMap.put("OrderReview_DC Item", "Items arrive in 2-5 business days Message not found in order review Page");
			status = WARNING;
		    }
		}
	    } else if (pageoption.equalsIgnoreCase("Yahoomail")) {
		// Click Continue
		if (isElementPresentVerification(YahooContinue_LNK, browser)) {
		    if (!isElementPresentVerifyClick(YahooContinue_LNK, browser)) {
			throw new Exception("Yahoomail: Failed to click Continue link");
		    }
		}
		// Check for Rx confirmation message
		if (!isElementPresentVerification(YahooRxSubject_LNK, browser)) {
		    messagesMap.put("Yahoo_RXMail", "YahooRx mail not received");
		    status = WARNING;
		}
		// Click Subject link of SS,CL , CH , PSC items orders
		if (!isElementPresentVerifyClick(YahooSSsubject_LNK, browser)) {
		    throw new Exception("Yahoomail: Failed to click Your Walgreens.com Order Details");
		}

		if (Checkval.equalsIgnoreCase("CheckAll")) {
		    // CL Mail plan
		    if (!isElementPresentVerification(YahooCLMailShipping_DIV, browser)) {
			messagesMap.put("Yahoo_CL Item", "Items arrive in 4 business days Message not found in order review Page");
			status = WARNING;
		    }
		    // PSC Giftcards
		    if (!isElementPresentVerification(YahooGiftPSCShipping_DIV, browser)) {
			messagesMap.put("Yahoo_PSC Giftcards Item", "Items arrive in 3-7 business days Message not found in order review Page");
			status = WARNING;
		    }
		    // DC CH items
		    if (!isElementPresentVerification(YahooDCCHShipping_DIV, browser)) {
			messagesMap.put("Yahoo_DC Item", "Items arrive in 2-5 business days Message not found in order review Page");
			status = WARNING;
		    }
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to click on Paypal checkout button
     * @author - Hasan Javeed
     * @Created - Sep 5th, 2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void CheckOutWithPaypalFromCart(EventFiringWebDriver browser, ScenarioBean scenario, StepBean stepBean, Map<String, List<String>> dataMap) {
	String PayPalExpressCheckout_BTN = "//input[@title='PayPal Express Checkout']~XPATH";
	String PayPalLogin_TXT = "//*[contains(text(), 'Pay with my PayPal account')]~XPATH";
	String ReviewOrderAndSubmit_HEADER = "//*[contains(text(),'Review and submit your order')]~XPATH";

	String expectedTargetPage = null;
	String status = PASS;
	boolean isOnExpectedTargetPage = false;
	Map<String, String> messagesMap = null;

	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    expectedTargetPage = dataMap.get("ExpectedTargetPage").get(0);

	    if (dataMap.get("PaypalButton").get(0).equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerification(PayPalExpressCheckout_BTN, browser)) {
		    messagesMap.put("Shopping Cart", "Checkout with paypal button is not there");
		    status = WARNING;
		}
	    } else if (dataMap.get("PaypalButton").get(0).equalsIgnoreCase("No")) {
		if (isElementPresentVerification(PayPalExpressCheckout_BTN, browser)) {
		    messagesMap.put("Shopping Cart", "Checkout with paypal button is not there");
		    status = WARNING;
		}
	    } else if (dataMap.get("PaypalButton").get(0).equalsIgnoreCase("Click")) {
		if (!isElementPresentVerifyClick(PayPalExpressCheckout_BTN, browser)) {
		    throw new Exception("Not able to click on Checkout with paypal button");
		}
	    }

	    if ("PaypalSignin".equals(expectedTargetPage)) {
		isOnExpectedTargetPage = isElementPresentVerification(PayPalLogin_TXT, browser);
	    } else if ("ReviewOrder".equals(expectedTargetPage)) {
		isOnExpectedTargetPage = isElementPresentVerification(ReviewOrderAndSubmit_HEADER, browser);
	    } else if ("-".equals(expectedTargetPage)) {
		isOnExpectedTargetPage = true;
	    }
	    if (!isOnExpectedTargetPage) {
		status = WARNING;
		messagesMap.put("ExpectedTargetPage", "Page is not navigated to the Respective Page");
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to login and change/add address for order in Paypal
     *          site
     * @author - Hasan Javeed
     * @Created - Sep 5th, 2013
     * @Modified By -Hasan Javeed
     * @Modified Date -OCT 23rd,2013
     ************************************************************* 
     */
    public static void paypalExpressCheckout(EventFiringWebDriver browser, ScenarioBean scenario, StepBean stepBean, Map<String, List<String>> dataMap) {
	String PayPal_Username_TXT = "input#login_email~CSS";
	String PayPal_Password_TXT = "input#login_password~CSS";
	String PayPal_Login_BTN = "input#submitLogin~CSS";
	String PayPal_Continue_BTN = "input#continue~CSS";
	String Paypal_AddressChange_BTN = "input#changeAddressButton~CSS";
	String ReviewOrderAndSubmit_HEADER = "//*[contains(text(),'Review and submit your order')]~XPATH";
	String AddNewAddress_LNK = "input#addShipAddress~CSS";
	String Paypal_Name_TXT = "input#shipping_addressee_name~CSS";
	String PaypalAddress_TXT = "input#shipping_address1~CSS";
	String PaypalCity_TXT = "input#shipping_city~CSS";
	String PaypalState_LST = "select#shipping_state~CSS";
	String PaypalZipCode_TXT = "input#shipping_zip~CSS";
	String PaypalSave_BTN = "input#continueBabySlider~CSS";
	String PaypalPreferred_CHK = "input#set_preferred_address";
	String VerifyYourCounty_Heading = "//*[contains(text(),'Verify your County') or contains(text(),'Verify your county')]~XPATH";
	String VerifyCountySelect_BTN = "input[value='Select']~CSS";
	String status = PASS;
	boolean isOnExpectedTargetPage = false;
	String UserName = null, Password = null, Name = null, StreetAddress = null, City = null, State = null, ZipCode = null, PreferedAddress = null, PaypalAddress = null, ExpectedTargetPage = null;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    UserName = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "UserName");
	    Password = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "Password");
	    Name = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "Name");
	    StreetAddress = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "StreetAddress");
	    City = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "City");
	    State = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "State");
	    ZipCode = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "ZipCode");
	    PreferedAddress = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "PreferedAddress");
	    PaypalAddress = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "PaypalAddress");
	    ExpectedTargetPage = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "ExpectedTargetPage");
	    if (!UserName.equalsIgnoreCase("-")) {
		if (!clearAndEnterText(PayPal_Username_TXT, UserName, browser)) {
		    messagesMap.put("Username", "Not able to enter User name");
		    status = WARNING;
		}
	    }
	    if (!Password.equalsIgnoreCase("-")) {
		if (!clearAndEnterText(PayPal_Password_TXT, Password, browser)) {
		    messagesMap.put("Password", "Not able to enter Password");
		    status = WARNING;
		}
	    }
	    if (!isElementPresentVerifyClick(PayPal_Login_BTN, browser)) {
		throw new Exception("Not able to click on Continue button in paypal site");
	    }
	    if (PaypalAddress.equalsIgnoreCase("Existing")) {
		if (!isElementPresentVerifyClick(PayPal_Continue_BTN, browser)) {
		    throw new Exception("Not able to click on Continue button in paypal site");
		}
	    } else if (PaypalAddress.equalsIgnoreCase("New")) {

		if (!isElementPresentVerifyClick(Paypal_AddressChange_BTN, browser)) {
		    throw new Exception("Not able to click on change button in paypal site");
		}

		if (!isElementPresentVerifyClick(AddNewAddress_LNK, browser)) {
		    throw new Exception("Not able to click on change button in paypal site");
		}
		if (!Name.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(Paypal_Name_TXT, Name, browser)) {
			messagesMap.put("Name", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!StreetAddress.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(PaypalAddress_TXT, StreetAddress, browser)) {
			messagesMap.put("streetaddress", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!City.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(PaypalCity_TXT, City, browser)) {
			messagesMap.put("City", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!State.equalsIgnoreCase("-")) {
		    WebElement stateListElement = getElementByProperty(PaypalState_LST, browser);
		    if (stateListElement != null) {
			new Select(stateListElement).selectByVisibleText(State);
		    } else {
			messagesMap.put("State", "Paypal site: Not able to get the new selectBox from paypal Page.");
			status = WARNING;
		    }
		}
		if (!ZipCode.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(PaypalZipCode_TXT, ZipCode, browser)) {
			messagesMap.put("Zipcode", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!PreferedAddress.equalsIgnoreCase("-")) {
		    if (isElementPresentVerifyClick(PaypalPreferred_CHK, browser)) {
			messagesMap.put("paypalprefered", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!isElementPresentVerifyClick(PaypalSave_BTN, browser)) {
		    throw new Exception("Not able to click on save button in paypal site");
		}
		if (!isElementPresentVerifyClick(PayPal_Continue_BTN, browser)) {
		    throw new Exception("Not able to click on Continue button in paypal site");
		}
	    }
	    if (isElementPresentVerification(VerifyYourCounty_Heading, browser)) {
		if (!isElementPresentVerifyClick(VerifyCountySelect_BTN, browser)) {
		    throw new Exception("Not able to click on select button in Verify County Page");
		}
	    }
	    if ("ReviewOrder".equals(ExpectedTargetPage)) {
		isOnExpectedTargetPage = isElementPresentVerification(ReviewOrderAndSubmit_HEADER, browser);
	    } else if ("-".equals(ExpectedTargetPage)) {
		isOnExpectedTargetPage = true;
	    }
	    if (!isOnExpectedTargetPage) {
		status = WARNING;
		messagesMap.put("ExpectedTargetPage", "Page is not navigated to the Respective Page");
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to verify, change address and place order for Pay pal
     * @author - Hasan Javeed
     * @Created - Sep 5th, 2013
     * @Modified By -Hasan Javeed
     * @Modified Date -OCT 23rd,2013
     ************************************************************* 
     */
    public static void paypalExpressRevieworder(EventFiringWebDriver browser, ScenarioBean scenario, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String Standardshipping_RADIO = "//input[@id='SSSTDStandard']~XPATH";
	String Expeditedshipping_RADIO = "//input[@id='SSSTDExpeditedRadio']~XPATH";
	// String ExpeditedAmount_TXT =
	// "//strong[contains(text(),'$8.99')]~XPATH";
	// String EstimatedShipping_TXT = "//p[contains(text(),'$8.99')]~XPATH";
	String EditAddress_BTN = "//input[@title='Edit address']~XPATH";
	String FirstName_TXT = "//input[@id='firstname']~XPATH";
	String LastName_TXT = "//input[@id='lastname']~XPATH";
	String Address_TXT = "//input[@id='address']~XPATH";
	String City_TXT = "//input[@id='city']~XPATH";
	String State_LST = "//select[@id='State']~XPATH";
	String Zipcode_TXT = "//input[@id='regzipcode2']~XPATH";
	String UpdateAddress_BTN = "//input[@title='Update address']~XPATH";
	String BalanceRewardsSaving_TXT = "//p[contains(text(),'Balance')]~XPATH";
	String EligiblePoints_TXT = "//p[contains(text(),'Eligible points:')]~XPATH";
	String VerifyYourAddress_Heading = "//*[contains(text(),'Verify your Shipping Address')]~XPATH";
	String VerifyAddressSelect_BTN = "//input[@type='submit'][@id='select-button']~XPATH";
	String AddressNotFound_MESSAGE = "//b[contains(text(),'Address Not Found') or contains(text(),'Incomplete Address')]~XPATH";
	String Continue_BTN = "//*[@title='Continue']~XPATH";
	String ExpeditedInEligible = "//div[contains(@class,'errorMsg')]~XPATH";
	String SubmitOrder_BTN = "//input[@id='submitTop' or @alt='Submit Order']~XPATH";
	String OrderConfirmation_Message = "//strong[contains(text(),'your order has been placed') or contains(text(),'Thank you for shopping at Walgreens') or contains(text(),'Thank You for shopping at Walgreens')]~XPATH";
	String FirstName = null, LastName = null, Address = null, City = null, State = null, ZipCode = null, SubmitOrder = null, ShippingMethod = null, EditAddress = null, EligiblePoints = null, RewardsSavings = null, ErrorValidations = null;
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    FirstName = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "FirstName");
	    LastName = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "LastName");
	    Address = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "StreetAddress");
	    City = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "City");
	    State = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "State");
	    ZipCode = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "ZipCode");
	    SubmitOrder = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "SubmitOrder");
	    ShippingMethod = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "ShippingMethod");
	    EditAddress = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "EditAddress");
	    EligiblePoints = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "EligiblePoints");
	    RewardsSavings = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "RewardsSavings");
	    ErrorValidations = getTestData(dataMap.get("InputFileName").get(0), dataMap.get("SheetName").get(0), dataMap.get("RowId").get(0), "ErrorValidations");
	    if (ShippingMethod.equalsIgnoreCase("Standard")) {
		if (!isElementPresentVerifyClick(Standardshipping_RADIO, browser)) {
		    throw new Exception("Not able to Click on standard radio button");
		}
	    } else if (ShippingMethod.equalsIgnoreCase("Expedited")) {
		if (!isElementPresentVerifyClick(Expeditedshipping_RADIO, browser)) {
		    throw new Exception("Not able to Click on expedited radio button");
		}
	    }
	    if (EditAddress.equalsIgnoreCase("Click")) {
		if (!isElementPresentVerifyClick(EditAddress_BTN, browser)) {
		    throw new Exception("Not able to Click on Edit address button");
		}

		if (!FirstName.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(FirstName_TXT, FirstName, browser)) {
			messagesMap.put("Name", "Not able to enter first name");
			status = WARNING;
		    }
		}
		if (!LastName.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(LastName_TXT, LastName, browser)) {
			messagesMap.put("Name", "Not able to enter first name");
			status = WARNING;
		    }
		}
		if (!Address.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(Address_TXT, Address, browser)) {
			messagesMap.put("Name", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!City.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(City_TXT, City, browser)) {
			messagesMap.put("Name", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!State.equalsIgnoreCase("-")) {
		    WebElement stateListElement = getElementByProperty(State_LST, browser);
		    if (stateListElement != null) {
			new Select(stateListElement).selectByIndex(Integer.parseInt(State));
		    } else {
			messagesMap.put("State", "Paypal site: Not able to get the new selectBox from paypal Page.");
			status = WARNING;
		    }
		}
		if (!ZipCode.equalsIgnoreCase("-")) {
		    if (!clearAndEnterText(Zipcode_TXT, ZipCode, browser)) {
			messagesMap.put("Name", "Not able to enter name");
			status = WARNING;
		    }
		}
		if (!isElementPresentVerifyClick(UpdateAddress_BTN, browser)) {
		    throw new Exception("Not able to Click on update address button");
		}
		// Verify Your Address Overlay
		if (isElementPresentVerification(VerifyYourAddress_Heading, browser)) {
		    if (!isElementPresentVerifyClick(VerifyAddressSelect_BTN, browser)) {
			throw new Exception("Not able to click on select button in Verify Address Page");
		    }
		}
		// Address not found situation
		if (isElementPresentVerification(AddressNotFound_MESSAGE, browser)) {

		    if (isElementPresentVerification(Continue_BTN, browser)) {
			getElementByProperty(Continue_BTN, browser).click();
		    } else {
			throw new Exception("Address Not Found Situation: Not able to click on Continue Button from Edit address Page.");
		    }
		}

	    }
	    if (EligiblePoints.equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerification(EligiblePoints_TXT, browser)) {
		    messagesMap.put("Review order", "Eligible points text not displayed");
		    status = WARNING;
		}

	    }
	    if (RewardsSavings.equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerification(BalanceRewardsSaving_TXT, browser)) {
		    messagesMap.put("Review order", "Balance rewards savings not displyed");
		    status = WARNING;
		}
	    }
	    if (!ErrorValidations.equalsIgnoreCase("-")) {
		if (ErrorValidations.equalsIgnoreCase("ExpeditedInEligible")) {
		    if (!isElementPresentVerification(ExpeditedInEligible, browser)) {
			messagesMap.put("Review order", "Expedited ineligible not displyed");
			status = WARNING;
		    }
		}
	    }
	    if (SubmitOrder.equalsIgnoreCase("Yes")) {
		if (!isElementPresentVerifyClick(SubmitOrder_BTN, browser)) {
		    throw new Exception("Not able to Click on Submit Order");
		}
		if (!isElementPresentVerification(OrderConfirmation_Message, browser)) {
		    throw new Exception("Not able to Find the Order Confiramtion Message");
		}
	    }
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose -To verify the Arrangement of products in Order Review Page
     * @author - Angeline A
     * @Created - 10/18/2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void verifyArrangementOfProducts(EventFiringWebDriver browser, StepBean stepBean) {
	String status = PASS;
	Map<String, String> messagesMap = null;
	String OrderReviewPage_DIV = "//div[@id='leftNavShippingInfo']~XPATH";
	String Sections = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    List<WebElement> ProductSections = getElementByProperty(OrderReviewPage_DIV, browser).findElements(By.xpath("//div[@id='productSection']"));
	    String[] SectionNames = { "Prescription Information", "Contact Lens Information", "Product Information" };
	    int NoOfSections = SectionNames.length;
	    if (NoOfSections == ProductSections.size()) {
		for (int i = 0; i < ProductSections.size(); i++) {
		    Sections = ProductSections.get(i).getText();
		    if (!Sections.contains(SectionNames[i])) {
			messagesMap.put("Product Sections", SectionNames[i] + "Section is missing");
			status = WARNING;
		    }
		}
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }

    /**
     ************************************************************* 
     * @Purpose -To validate the applied reward points
     * @author - Rukmani RM
     * @Created - 10/23/2013
     * @Modified By -
     * @Modified Date -
     ************************************************************* 
     */
    public static void rewardsAppliedforBurnPts(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	Map<String, String> messagesMap = null;
	String BeforeTotalPrice = "//div[contains(@class, 'brdTopDtdSdd')]/div/p[contains(@class, 'orderSummText')][2]/strong~XPATH";
	String AfterTotalPrice = "//div[@class='totalPrc']~XPATH";
	String RedemptionPts = "//p[@class='RtotalPrc']~XPATH";
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    String BeforeRedemptionVal = null;
	    float ConvPriceBR = 0;
	    String BeforeRedemption = getElementByProperty(BeforeTotalPrice, browser).getText();
	    BeforeRedemptionVal = BeforeRedemption.split("\\$")[1];
	    ConvPriceBR = Float.parseFloat(BeforeRedemptionVal);

	    float ConvRedemptionValue = 0;
	    String RedemptionPoints = getElementByProperty(RedemptionPts, browser).getText();
	    String RedemptionPointsPrice = RedemptionPoints.split("\\$")[1];
	    ConvRedemptionValue = Float.parseFloat(RedemptionPointsPrice);
	    String AfterRedemption = getElementByProperty(AfterTotalPrice, browser).getText();
	    String AfterRedemptionVal = AfterRedemption.split("\\$")[1];
	    float ConvPriceAR = Float.parseFloat(AfterRedemptionVal);
	    if (ConvPriceBR != ConvPriceAR + ConvRedemptionValue) {
		messagesMap.put("Expected Target Page", "Selected Burn points is not deducted from the total price");
		status = WARNING;
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}

    }
    

    /**
     ************************************************************* 
     * @Purpose - Method to select required option (home address or shipping
     *          address or new shipping address ) from shipping Info Page
     * @author - Imran
     * @Created - Sep-30-2013
     * @Modified By - Hasan
     * @Modified Date -12-FEB-2014
     ************************************************************* 
     */
    public static void selectShippingOptionFromShippingInfoPage(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String shippingAddressType = null;
	String Continue_BTN = "//input[@title='Continue' or @title='Continue checkout']~XPATH";
	String ShippingMethod_Heading = "//*[contains(text(),'Ship Method') or contains(text(),'Shipped to you') or contains(text(),'Delivery details')]~XPATH";
	String AddressNotFound_MESSAGE = "//b[contains(text(),'Address Not Found') or contains(text(),'Incomplete Address')]~XPATH";
	String AddressNotFound_TXT = "//p[contains(text(),'We do not recognize the')or contains(text(),'The United States Postal Service')]~XPATH";
	String VerifyYourCounty_Heading = "//h6[contains(text(),'Verify your County') or contains(text(),'Verify your county')]~XPATH";
	String VerifyYourAddress_Heading = "//*[contains(text(),'Verify your Shipping Address')]~XPATH";
	String VerifyAddressSelect_BTN = "//input[@type='submit'][@id='select-button']~XPATH";
	String VerifyCountySelect_BTN = "input[value='Select']~CSS";
	String FirstName_TXT = "//input[@id='firstName'  or @id='newShippingFirstName' or @id='firstname']~XPATH";
	String LastName_TXT = "//input[@id='newShippingLastName'  or @id='lastName' or @id='lastname']~XPATH";
	String StreetAddress_TXT = "//input[@id='streetAddress1'  or @id='address' or @id='streetAddress' or @id='shipAddress']~XPATH";
	String City_TXT = "//input[@id='newShippingCity'  or @id='city' or @id='editShipCity']~XPATH";
	String ShippingState_LST = "//select[@id='newShippingState'  or @id='state' or @id='editShipState' or @id='State']~XPATH";
	String ZipCode_TXT = "//input[@id='newShippingPostalCode'  or @id='zip' or @id='editZipCode' or @id='regzipcode2']~XPATH";
	String EmailAddress_TXT = "//input[@id='newShippingEmailId'  or @id='email1' or @id='emailAddress']~XPATH";
	String PhoneNumber_TXT = "//input[@id='newShippingPhoneNumber'  or @id='phone' or @id='phoneNumber' or @id='phonenumber']~XPATH";
	String SaveasPreffered_CHK = "input#editShipSaveAsPrefAddr~CSS"; // SIMEON
	// -
	// 8/29/13
	// -
	// Fixed
	String OffersbyEmail_CHECK = "//input[@id='optIn' or @id='optInInd']~XPATH";
	String UnionTerriotoryAddressError_ELM = "//div[@id='leftNavShippingInfo']/form[@name='shipinfo']//div[contains(@class, 'error')]//p[contains(text(),'At this time')]~XPATH";
	String BacktoAddress_LNK = "//a[@title='Back to address']~XPATH";
	String ShipAddress_DIV = "//p[contains(text(),'Shipping Information')]~XPATH"; // SIMEON
	// -
	// 8/29/13
	// -
	// Fixed
	String ChangeAddress_BTN = "//*[@alt='Change address' or @title='Change Address']~XPATH";
	String AddNewAddressBook_BTN = "//input[@title='Add New Address']~XPATH";
	String SaveandSelect_BTN = "input[title='Select and Save']~CSS";
	String EditAddres_BTN = "//input[@title='Edit this address']~XPATH";
	String PrefferedAddressText_ELM = "//div[contains(text(),'Preferred address')]~XPATH";
	String Delete_LNK = "//*[@id='addressCardSection']/div[2]/a[@title='Delete']~XPATH";
	String SelectAddressHome_BTN = "//*[@id='addressCardSection']/div[1]/input~XPATH";
	String SelectAddressShip_BTN = "//*[@id='addressCardSection']/div[2]/input~XPATH";
	String Delete_BTN = "a[title='Delete']~CSS";
	String Close_BTN = "img[title='Close']~CSS";
	String OptimizedCheckoutFlag = null;
	String PrepopulatedEmailAddress=null;
	String Ship_Address_Locator = "//div[@id='rightNav']/div[2]~XPATH";
	String OptimizedCheckout_Heading = "//h2[contains(text(),'Checkout')]~XPATH";
	String OptimizedChangeAddress_BTN = "//a[contains(text(),'Change address')]~XPATH";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    Map<String, String> sharedProperties = null;
	    sharedProperties = scenarioBean.getSharedStepProperties();
	    if (sharedProperties == null) {
		sharedProperties = new HashMap<String, String>();
		scenarioBean.setSharedStepProperties(sharedProperties);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		shippingAddressType = dataMap.get("ShippingAddressType").get(i);
		if(dataMap.containsKey("OptimizedCheckout")){
			OptimizedCheckoutFlag = dataMap.get("OptimizedCheckout").get(i);
		}

		if (OptimizedCheckoutFlag != null) {
		    if (OptimizedCheckoutFlag.equalsIgnoreCase("Yes")) {

			String CurrentUrl = browser.getCurrentUrl().toString();
			CurrentUrl = CurrentUrl + "&test=b";
			System.out.println("CurrentUrl:" + CurrentUrl);
			getUrl(browser, CurrentUrl);

			if (!isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
			    throw new Exception("User dint navigate to Optimized checkout page");
			}

		    }
		}

		if ("homeaddress".equalsIgnoreCase(shippingAddressType)) {
		    // New AB changes ----HASAN--24/Jul/2013
		    // change address check for PSC only in cart scenario

		    if (isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
			if (!isElementPresentVerifyClick(OptimizedChangeAddress_BTN, browser)) {
			    throw new Exception("Not able to click on change address button in optimized checkout page");
			}
			if (!isElementPresentVerifyClick(SelectAddressHome_BTN, browser)) {
			    throw new Exception("Not able to Select home Address Address Section");
			}
		    } else if (isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
			// MOdified for Choosing home address-
			if (isElementPresentVerification(Delete_LNK, browser)) {
			    if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
				throw new Exception("Not able to Select Address Button in Home Address Section");
			    }
			    if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
				throw new Exception("Not able to Click on Change Address Button");
			    }
			    if (!isElementPresentVerifyClick(SelectAddressHome_BTN, browser)) {
				throw new Exception("Not able to Select Address Button in Home Address Section");
			    }
			} else {
			    if (!isElementPresentVerifyClick(Close_BTN, browser)) {
				throw new Exception("Not able to Click on close Button");
			    }
			}
		    }
		} else if ("shippingaddress".equalsIgnoreCase(shippingAddressType)) {

		    // New AB changes ----HASAN--24/Jul/2013
		    if (isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
			if (!isElementPresentVerifyClick(OptimizedChangeAddress_BTN, browser)) {
			    throw new Exception("Not able to click on change address button in optimized checkout page");
			}
			if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
			    throw new Exception("Not able to Select shipping Address Section");
			}
		    } else if (isElementPresentVerification(ChangeAddress_BTN, browser)) {

			if (!isElementPresentVerifyClick(ChangeAddress_BTN, browser)) {
			    throw new Exception("Not able to Click on Change Address Button");
			}
			if (!isElementPresentVerifyClick(SelectAddressShip_BTN, browser)) {
			    throw new Exception("Not able to Select Address Button in Shipping Address Section");
			}
		    }
		} else if ("newshippingaddress".equalsIgnoreCase(shippingAddressType) || "Editshippingaddress".equalsIgnoreCase(shippingAddressType)) {
		    if ("Editshippingaddress".equalsIgnoreCase(shippingAddressType)) {
			if (!isElementPresentVerifyClick(EditAddres_BTN, browser)) {
			    throw new Exception("Edit Shipping Address: Not able to click on Edit Address Button from Shipping Information Page.");
			}
		    } else if (isElementPresentVerification(ChangeAddress_BTN, browser)) {
			getElementByProperty(ChangeAddress_BTN, browser).click();
			// Delete one Address
			if (isElementPresentVerification(Delete_LNK, browser)) {
			    getElementByProperty(Delete_LNK, browser).click();
			    Thread.sleep(1000);
			}
			if (isElementPresentVerification(AddNewAddressBook_BTN, browser)) {
			    getElementByProperty(AddNewAddressBook_BTN, browser).click();
			}
		    }
		    if (!"-".equals(dataMap.get("FirstName").get(i))) {
			if (!clearAndEnterText(FirstName_TXT, dataMap.get("FirstName").get(i), browser)) {
			    messagesMap.put("First Name", "Not able to Enter First Name");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("LastName").get(i))) {
			if (!clearAndEnterText(LastName_TXT, dataMap.get("LastName").get(i), browser)) {
			    messagesMap.put("Last Name", "Not able to Enter Last Name.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("StreetAddress").get(i))) {
			if (!clearAndEnterText(StreetAddress_TXT, dataMap.get("StreetAddress").get(i), browser)) {
			    messagesMap.put("StreetAddress", "Not able to Enter Street Address.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("City").get(i))) {
			if (!clearAndEnterText(City_TXT, dataMap.get("City").get(i), browser)) {
			    messagesMap.put("City", "Not able to Enter City.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("State").get(i))) {
			WebElement stateListElement = getElementByProperty(ShippingState_LST, browser);
			if (stateListElement != null) {
			    new Select(stateListElement).selectByIndex(Integer.parseInt(dataMap.get("State").get(i)));
			} else {
			    messagesMap.put("State", "New Shipping Address: Not able to get the new selectBox from Shipping Information Page.");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("ZipCode").get(i))) {
			if (!clearAndEnterText(ZipCode_TXT, dataMap.get("ZipCode").get(i), browser)) {
			    messagesMap.put("Zip Code", "Not able to Enter Zip Code.");
			    status = WARNING;
			}
		    }
		    // Checking user is logged in or not. if email address
		    // prepopulated, he is a logged-in user.
		    PrepopulatedEmailAddress = null;
		    if (isElementPresentVerification(EmailAddress_TXT, browser)) {
			PrepopulatedEmailAddress = getElementByProperty(EmailAddress_TXT, browser).getAttribute("value");
		    }
		    if ("yes".equalsIgnoreCase(dataMap.get("SaveShippingAddress").get(i))) {
			/*
			 * WebElement checkBox =
			 * getElementByProperty(SaveasPreffered_CHK, browser);
			 * if (checkBox != null) { checkBox.click(); } else {
			 * messagesMap.put("Save as Preffered CheckBox",
			 * " Not able to click on Save as Preffered CheckBox");
			 * status = WARNING; }
			 */
			if (!checkBoxSelection(browser, SaveasPreffered_CHK, "SELECT")) {
			    messagesMap.put("Save as Preffered CheckBox", " Not able to click on Save as Preffered CheckBox");
			    status = WARNING;
			}
		    }
		    if (dataMap.get("OffersbyEmail") != null) {
			if (dataMap.get("OffersbyEmail").get(0).equalsIgnoreCase("Yes")) {
			    if (!isElementPresentVerifyClick(OffersbyEmail_CHECK, browser)) {
				messagesMap.put("SOffers by Email checkbox", "Not able to click on Offers by Email checkbox");
				status = WARNING;
			    }
			}
		    }
		    if (!"-".equals(dataMap.get("EmailAddress").get(i))) {
			if (!clearAndEnterText(EmailAddress_TXT, dataMap.get("EmailAddress").get(i), browser)) {
			    messagesMap.put("Email Address", "Not able to Enter Email Address.");
			    status = WARNING;
			}
		    }
		    // click on Save and Select only Logged in user
		    if (isElementPresentVerification(SaveandSelect_BTN, browser)) {
			if (!isElementPresentVerifyClick(SaveandSelect_BTN, browser)) {
			    throw new Exception("Not able to Click on Save and Select Button");
			}
		    }
		    if ("yes".equalsIgnoreCase(dataMap.get("SaveShippingAddress").get(i))) {
			if (!isElementPresentVerification(PrefferedAddressText_ELM, browser)) {
			    messagesMap.put("Preffered Addres Message", "Message is missing beside selected address");
			    status = WARNING;
			}
		    }
		    if (!"-".equals(dataMap.get("PhoneNumber").get(i))) {
			if (!clearAndEnterText(PhoneNumber_TXT, dataMap.get("PhoneNumber").get(i), browser)) {
			    messagesMap.put("Phone Number", "Not able to Enter Phone Number.");
			    status = WARNING;
			}
		    }
		}
		// click continue Button in General flow. Donot click
		// ContinueButton if it mention explicitely, so it will be
		// useful while validating error Message.
		if (dataMap.get("Continue") == null) {
		    if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
			throw new Exception("Not able to Click on continue Button in Shipping info Page");
		    }
		}
		// Address not found situation
		if (isElementPresentVerification(AddressNotFound_MESSAGE, browser)) {
		    if (!isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
			String AddressNotFoundMessage = getTestData("CommonData", "GenaralInfo", "AddressNotFoundMessage", "Message").trim();
			String AddressNotFound = getElementByProperty(AddressNotFound_TXT, browser).getText().trim();
			String AddressIncompleteMessage = getTestData("CommonData", "GenaralInfo", "IncompleteAddress", "Message").trim();
			if (!AddressNotFound.equals(AddressNotFoundMessage) && !AddressNotFound.equals(AddressIncompleteMessage)) {
			    messagesMap.put("Address not found message", "address not found message is not matching");
			    status = WARNING;

			}
			if (isElementPresentVerification(Continue_BTN, browser)) {
			    getElementByProperty(Continue_BTN, browser).click();
			} else {
			    throw new Exception("Address Not Found Situation: Not able to click on Continue Button from Shipping Information Page.");
			}
		    }

		}
		if (dataMap.get("ErrorValidation") != null) {
		    if (dataMap.get("ErrorValidation").get(i).equalsIgnoreCase("UnionTerritory")) {
			if (!isElementPresentVerification(UnionTerriotoryAddressError_ELM, browser)) {
			    messagesMap.put("Union Terrotory Address ", "Error Message is not being displayed");
			    status = WARNING;
			}
		    }
		}
		// Verify Your Address Overlay
		if (isElementPresentVerification(VerifyYourAddress_Heading, browser)) {
		    if (!isElementPresentVerifyClick(VerifyAddressSelect_BTN, browser)) {
			throw new Exception("Not able to click on select button in Verify Address Page");
		    }
		}
		// Verify County Back to address validation
		// Modified by Fyrose Apr-10
		if (dataMap.get("CountyBacktoAddress") != null) {
		    if (dataMap.get("CountyBacktoAddress").get(0).equalsIgnoreCase("BacktoAddress")) {
			if (isElementPresentVerification(VerifyYourCounty_Heading, browser)) {
			    if (!isElementPresentVerifyClick(BacktoAddress_LNK, browser)) {
				throw new Exception("Not able to click on Back to address link");
			    }
			    if (!isElementPresentVerification(ShipAddress_DIV, browser)) {
				messagesMap.put("Verify your County ", "Shipping address page is not displayed");
				status = WARNING;
			    }
			} else {
			    messagesMap.put("Verify your County ", "Verify your conty page not displayed");
			    status = WARNING;
			}
		    }
		}
		// Verify Your County page
		if (isElementPresentVerification(VerifyYourCounty_Heading, browser)) {
		    if (!isElementPresentVerifyClick(VerifyCountySelect_BTN, browser)) {
			throw new Exception("Not able to click on select button in Verify County Page");
		    }
		}
		if (dataMap.get("CountyBacktoAddress") != null) {
		    // do Nothing
		} else if ((dataMap.get("ErrorValidation") == null || dataMap.get("ErrorValidation").get(i).equals("-")) && dataMap.get("Continue") == null) {

		    if (isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
			System.err.println("Optimized Checkout page");
		    } else if (!isElementPresentVerification(ShippingMethod_Heading, browser)) {
			messagesMap.put("Shipping Method Page", "ANot able to Verify the Shipping Method Page after navigating from Shipping Information Page.");
			status = WARNING;
		    }
		}
		// Store the Address from Shipping info page into shared
		// properties HashMap
		String Shipping_Address = getElementByProperty(Ship_Address_Locator, browser).getText();
		if (!Shipping_Address.equals("")) {
		    Shipping_Address = Shipping_Address.substring(0, 47).trim();
		}
		sharedProperties.put("Address_Shipping_Info_Page", Shipping_Address);
	    } // end of for
	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************* 
     * @Purpose - Method to Select shipping speed(Rx shipping/DL shipping/CL
     *          Shipping) from shipping Method page
     * @author - Imran
     * @Created -
     * @Modified By - Hasan
     * @Modified Date -12-FEB-14
     ************************************************************* 
     */
    public static void selectShippingSpeedFromShippingMethodPage(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String dailyLivingShippingSpeed = null;
	String contactLensShippingSpeed = null;
	String rxShippingSpeed = null;
	String CLStandardShippingText = null, CLOvernightShippingText = null;
	String Continue_BTN = "//input[@title='Continue' or @title='Continue checkout' or @title='Continue ']~XPATH";

	
	  String SelectDLStandardShipping_BTN ="//input[@id='SSSTDStandard' or @id='proStdArrInBusinessDays']~XPATH"; 
	  String SelectDLExpeditedShipping_BTN = "//input[@id='SSSTDExpeditedRadio' or @id='proExpArrInBusinessDays']~XPATH";
	  
	  //String SelectDLStandardShipping_BTN = "//input[@id='proStdArrInBusinessDays']~XPATH";
	  //String SelectDLExpeditedShipping_BTN = "//input[@id='proExpArrInBusinessDays']~XPATH";

	 /*
	 * String SelectCLStandardShipping_BTN = "input#CLStandardRadio~CSS";
	 * String SelectCLOvernightShipping_BTN = "input#CLOvernightRadio~CSS";
	 */

	String SelectCLStandardShipping_BTN = "//input[@id='CLStandardRadio' or @id='StdArrInBusinessDays']~XPATH";
	String SelectCLOvernightShipping_BTN = "//input[@id='CLOvernightRadio' or @id='expArrInBusinessDays']~XPATH";

	String SelectRxStandardShipping_BTN = "input#shippingspeedradio_standard~CSS";
	String SelectRxExpeditedShipping_BTN = "input#shippingspeedradio_expedited~CSS";
	String SelectRxOvernightShipping_BTN = "input#shippingspeedradio_overnight~CSS";

	String PaymentInformation_Heading = "//*[contains(text(),'Payment')]~XPATH";
	String OptimizedCheckout_Heading = "//h2[contains(text(),'Checkout')]~XPATH";

	String CLStandardShipping_TXT = "//label[@for = 'CLStandardRadio']~XPATH";
	String CLOvernightShipping_TXT = "//label[@for = 'CLOvernightRadio']~XPATH";
	String Change_LNK = "//a[@title='Change Shipping Information']~XPATH";
	String ContactLensesHeader_H = "//h3[contains(text(),'Contact Lenses')]~XPATH";

	String CLStandardShipping__SDD_ON_DIV = "//div[@class='wid19p2em']/div~XPATH";
	String CLOvernightShipping__SDD_ON_DIV = "//div[@class='wid19p2em']/div[2]~XPATH";

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		dailyLivingShippingSpeed = dataMap.get("DailyLivingShippingSpeed").get(i);
		contactLensShippingSpeed = dataMap.get("ContactLensShippingSpeed").get(i);
		rxShippingSpeed = dataMap.get("RxShippingSpeed").get(i);

		if ("standard".equalsIgnoreCase(dailyLivingShippingSpeed)) {
		    if (isElementPresentVerification(SelectDLStandardShipping_BTN, browser)) {
			getElementByProperty(SelectDLStandardShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectDLStandardShipping_BTN from Shipping Method Page.");
		    }
		} else if ("expedited".equalsIgnoreCase(dailyLivingShippingSpeed)) {
		    if (isElementPresentVerification(SelectDLExpeditedShipping_BTN, browser)) {
			getElementByProperty(SelectDLExpeditedShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectDLExpeditedShipping_BTN from Shipping Method Page.");
		    }
		}

		if ("standard".equalsIgnoreCase(contactLensShippingSpeed)) {
		    // CL copy Check ----HASAN--26/FEB/2013 String
		    if (dataMap.get("CLShipMethodMessage") != null) {
			if (dataMap.get("CLShipMethodMessage").get(0).equalsIgnoreCase("Yes")) {
			    // CL copy Check ----HASAN--26/FEB/2013
			    String CLStandardShippingMessage = getTestData("CommonData", "GenaralInfo", "CLStandardShippingMessage", "Message");
			    String CLOvernightShippingMessage = getTestData("CommonData", "GenaralInfo", "CLOvernightShippingMessage", "Message");
			    if (SDDFlag.equalsIgnoreCase("ON")) {
				CLStandardShippingText = getElementByProperty(CLStandardShipping__SDD_ON_DIV, browser).getText();
				CLOvernightShippingText = getElementByProperty(CLOvernightShipping__SDD_ON_DIV, browser).getText();
			    } else {
				CLStandardShippingText = getElementByProperty(CLStandardShipping_TXT, browser).getText();
				CLOvernightShippingText = getElementByProperty(CLOvernightShipping_TXT, browser).getText();
			    }
			    if (!CLStandardShippingText.contains(CLStandardShippingMessage)) {
				messagesMap.put("CL - shipping method message", "Contact lens standard text is wrong in Shipping Method Page.");
				status = WARNING;
			    }
			    if (!CLOvernightShippingText.contains(CLOvernightShippingMessage)) {
				messagesMap.put("CL - shipping method message", "Contact lens overnight text is wrong in Shipping Method Page.");
				status = WARNING;
			    }
			}
		    }
		    if (isElementPresentVerification(SelectCLStandardShipping_BTN, browser)) {
			getElementByProperty(SelectCLStandardShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectCLStandardShipping_BTN from Shipping Method Page.");
		    }
		} else if ("overnight".equalsIgnoreCase(contactLensShippingSpeed)) {
		    if (isElementPresentVerification(SelectCLOvernightShipping_BTN, browser)) {
			getElementByProperty(SelectCLOvernightShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectCLOvernightShipping_BTN from Shipping Method Page.");
		    }
		} else if (!(dataMap.get("ExpVerification") == null)) {// #
		    // ADDED
		    // -
		    // SARAVANAN
		    // M
		    // -6-MAY-2013
		    // -
		    // Verifying
		    // unavailability
		    // of
		    // Expedited
		    // shiiping
		    // option
		    // for CL
		    // Products
		    if (dataMap.get("ExpVerification").get(i).equalsIgnoreCase("Yes")) {
			if (isElementPresentVerification(ContactLensesHeader_H, browser)) {
			    if (getElementByProperty("//div[contains(@class,'prodInnerContainer')]", browser).getText().contains("Expedited")) {
				messagesMap.put("Expedited option - Contact Lenses", "The Expedited option should not displayed for CL Products");
				status = WARNING;
			    }
			}
		    }
		}

		if ("standard".equalsIgnoreCase(rxShippingSpeed)) {
		    if (isElementPresentVerification(SelectRxStandardShipping_BTN, browser)) {
			getElementByProperty(SelectRxStandardShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectRxStandardShipping_BTN from Shipping Method Page.");
		    }
		} else if ("expedited".equalsIgnoreCase(rxShippingSpeed)) {
		    if (isElementPresentVerification(SelectRxExpeditedShipping_BTN, browser)) {
			getElementByProperty(SelectRxExpeditedShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectRxExpeditedShipping_BTN from Shipping Method Page.");
		    }
		} else if ("overnight".equalsIgnoreCase(rxShippingSpeed)) {
		    if (isElementPresentVerification(SelectRxOvernightShipping_BTN, browser)) {
			getElementByProperty(SelectRxOvernightShipping_BTN, browser).click();
		    } else {
			throw new Exception("Missing SelectRxOvernightShipping_BTN from Shipping Method Page.");
		    }
		}

	    }// end of for loop

	    // new code change link ----HASAN--23/FEB/2013

	    if ((dataMap.get("ChangeLink") != null) && (dataMap.get("ChangeLink").get(0).equalsIgnoreCase("Yes"))) {
		if (!isElementPresentVerifyClick(Change_LNK, browser)) {
		    throw new Exception("Not able to click on Change Link in Shipping Method Page.");
		}
	    } else {
		if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
		    throw new Exception("Not able to click on Continue Button from Shipping Method Page.");
		}
		if (isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
		    System.err.println("Optimized Checkout page");
		} else if (!isElementPresentVerification(PaymentInformation_Heading, browser)) {
		    messagesMap.put("Expected Target Page", "Not able to Verify the Payment Information Page after navigating from Shipping Method Page.");
		    status = WARNING;
		}
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

  

    /**
     ************************************************************************ 
     * @Purpose - Method to select Payment options and Billing address in
     *          Payment Info page
     * @Input -
     * @author - Vishnu
     * @Created - 22 May 2012
     * @Modified By -Hasan
     * @Modified Date - 12-FEB-2014
     ************************************************************************ 
     */
    public static void paymentOptionsSelection(EventFiringWebDriver browser, ScenarioBean scenarioBean, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String CreditCard_RADIO = "input#paymentCC~CSS";
	String BillMeLater_RADIO = "input#paymentBML~CSS";
	String PayPal_RADIO = "input[value='paypal']~CSS";
	String Continue_BTN = "//input[@title='Continue' or @title='continue' or @title='Continue checkout']~XPATH";
	String CardType_LST = "select#creditcardtype~CSS";
	String CardNumber_TXT = "//input[@id='credit_card_number' or @id='ccno' or @id = 'cardNumber']~XPATH";
	String ExpirationMonth_LST = "//select[@id='expdate' or @id='exp_month']~XPATH";
	String ExpirationYear_LST = "//select[@id='yr1' or @id='exp_year' or @id='yr']~XPATH";
	String HomeAddress_RADIO = "//input[@id='chrisaddress1' or @id='homeaddressradio']~XPATH";
	// String ShippingAddress_RADIO =
	// "//input[@id='chrisaddress2' or @id='shippingaddressradio']~XPATH";
	String NewBillingAddress_RADIO = "//input[@id='billaddrnew' or @id='usebillinginfo']~XPATH";
	String SameAsShippingAddress_CHK = "//input[@id='samePaymentAdd' or @id='checkbill']~XPATH";// "input#checkbill~CSS";
	String FirstName_TXT = "//input[@id='fname' or @id='firstname' or @id='ccholderfname']~XPATH";
	String LastName_TXT = "//input[@id='lastname' or @id='lname' or @id='ccholderlname']~XPATH";
	String StreetAddress_TXT = "//input[@id='address2' or @id='newbillccaddress' or @id = 'address']~XPATH";
	String City_TXT = "//input[@id='city2' or @id='newbillcccity' or @id='city']~XPATH";
	String State_LST = "//select[@id='newbillccstate' or @id='newBillState' or @id ='State']~XPATH";
	String ZIPCode_TXT = "//input[@id='newbillcczip' or @id='zip2' or @id = 'regzipcode2']~XPATH";
	String SaveBillingAdd_CHK = "//input[@id='yesBill' or @id='yes']~XPATH";
	String UpdateCCInformation_LNK = "//a[@title='Update Credit Card Details' or @title='Edit payment information']~XPATH";
	String NewCreditCard_RADIO = "//p/input[@id='charge_cc' or @id='newcc' or @id='ccnew']~XPATH";
	String SelectaPaymentMethodTypeHeader_ELM = "//h3[contains(text(),'Select a payment method')]~XPATH";
	String EditCreditCartInformation_LNK = "//a[contains(text(),'Edit payment information')]~XPATH";
	String ReviewOrderAndSubmit_HEADER = "//*[contains(text(),'Order review') or contains(text(),'Review Order')]~XPATH";
	String BMLHomeAddress_RADIO = "input#homeaddressradio~CSS";
	// String BMLFirstName_TXT = "input#ccholderfname~CSS";
	// String BMLLastName_TXT = "input#ccholderlname~CSS";
	String BMLEmailAddress_TXT = "input#newbillemailid~CSS";
	String BMLPhoneNumber_TXT = "input#newbillphoneno~CSS";
	String BML_DOB_MONTH_LST = "//select[@name='/commerce/payment/bml/BMLFormHandler2.month' or @id='dobmm']~XPATH";
	String BML_DOB_DAY_LST = "//select[@name='/commerce/payment/bml/BMLFormHandler2.date' or @id='dobdd']~XPATH";
	String BML_DOB_YEAR_LST = "//select[@name='/commerce/payment/bml/BMLFormHandler2.year' or @id='dobyyyy']~XPATH";
	String BML_SSN_TXT = "input#newbillSSN~CSS";
	String BML_IAgree_CHK = "input#eTC~CSS";
	// SIMEON - 8/28/13 Corrected capitalization; 10/29/13 Again... it keeps
	// changing.
	String BML_AgreeandContinue_BTN = "//input[@title='I agree and continue order' or @title='I Agree and Continue Order' or @title = 'I agree and continue to order']~XPATH";
	String HavePayPalAccount_HEADER = "//h2[contains(text(),'Choose a way to pay')]~XPATH";
	String PayPal_Username_TXT = "input#login_email~CSS";
	String PayPal_Password_TXT = "input#login_password~CSS";
	String PayPal_Login_BTN = "input#submitLogin~CSS";
	String PayPal_Continue_BTN = "input#continue~CSS";
	String BMLContinue_BTN = "//input[@title='Continue']~XPATH";

	// String PaymentInformation_HEADER =
	// "//span[contains(text(),'Payment Information')]~XPATH";

	// Redeem options
	String RedeemBalanceRewards_H = "//h3[contains(text(),'Redeem Balance Rewards')]~XPATH";
	String RedeemPoints_LST = "//select[@id='selectedAwardId']~XPATH";
	String BeforeTotalPrice = "//div[@class='totalPrc']~XPATH";
	String AfterTotalPrice = "//div[@class='totalPrc']~XPATH";
	String OptimizedCheckout_Heading = "//h2[contains(text(),'Checkout')]~XPATH";
	String VerifyCountySelect_BTN = "input[value='Select']~CSS";
	String VerifyYourCounty_Heading = "//*[contains(text(),'Verify your County') or contains(text(),'Verify your county')]~XPATH";
	String ChangePayment_BTN = "//a[contains(text(),'Change payment')]~XPATH";

	String cardType = null;
	String cardNumber = null;
	String expireMonth = null;
	String expireYear = null;
	String firstName = null;
	String lastName = null;
	String streetAddress = null;
	String city = null;
	String state = null;
	String zipCode = null;
	String emailAddress = null;
	String phoneNumber = null;

	String dobMonth = null;
	String dobDay = null;
	String dobYear = null;
	String ssn = null;

	String payPalUserName = null;
	String payPalPassWord = null;

	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }

	    if (dataMap.get("CCInputFileName") != null && dataMap.get("CCInputFileName").size() > 0 && dataMap.get("CCSheetName") != null && dataMap.get("CCSheetName").size() > 0
		    && dataMap.get("CCRowId") != null && dataMap.get("CCRowId").size() > 0) {
		cardType = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "CardType");
		cardNumber = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "CardNumber");
		expireMonth = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ExpireMonth");
		expireYear = getTestData(dataMap.get("CCInputFileName").get(0), dataMap.get("CCSheetName").get(0), dataMap.get("CCRowId").get(0), "ExpireYear");
	    }

	    if (dataMap.get("CustomerInputFileName") != null && dataMap.get("CustomerInputFileName").size() > 0 && dataMap.get("CustomerSheetName") != null
		    && dataMap.get("CustomerSheetName").size() > 0 && dataMap.get("CustomerRowId") != null && dataMap.get("CustomerRowId").size() > 0) {
		firstName = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "FirstName");
		lastName = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "LastName");
		streetAddress = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "StreetAddress");
		city = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "City");
		state = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "State");
		zipCode = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "ZipCode");
		emailAddress = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "EmailAddress");
		phoneNumber = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "PhoneNumber");
		dobMonth = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "DOB-Month");
		dobDay = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "DOB-Day");
		dobYear = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "DOB-Year");
		ssn = getTestData(dataMap.get("CustomerInputFileName").get(0), dataMap.get("CustomerSheetName").get(0), dataMap.get("CustomerRowId").get(0), "SSN");
	    }

	    // In order to select the Redemption points - SARAVANAN M -9/10/2013
	    // Select the redemption points and validate the rewards applied -
	    // Rukmani RM - 23/10/2013

	    if (dataMap.containsKey("RedeemPtsOption") && !dataMap.get("RedeemPtsOption").get(0).equals("-")) {
		if (isElementPresentVerification(RedeemBalanceRewards_H, browser)) {
		    int Option = Integer.parseInt(dataMap.get("RedeemPtsOption").get(0).trim());
		    String BeforeRedemptionVal = null;
		    float ConvPriceBR = 0;
		    String BeforeRedemption = getElementByProperty(BeforeTotalPrice, browser).getText();
		    BeforeRedemptionVal = BeforeRedemption.split("\\$")[1];
		    System.out.println("BeforeRedemptionVal:" + BeforeRedemptionVal);
		    ConvPriceBR = Float.parseFloat(BeforeRedemptionVal);

		    List<WebElement> PointsList = new Select(getElementByProperty(RedeemPoints_LST, browser)).getOptions();
		    float ConvRedemptionValue = 0;
		    String RedemptionValue = PointsList.get(Option).getText();
		    RedemptionValue = RedemptionValue.split("\\$")[1];
		    ConvRedemptionValue = Float.parseFloat(RedemptionValue);
		    new Select(getElementByProperty(RedeemPoints_LST, browser)).selectByIndex(Option);
		    String AfterRedemption = getElementByProperty(AfterTotalPrice, browser).getText();
		    String AfterRedemptionVal = AfterRedemption.split("\\$")[1];
		    float ConvPriceAR = Float.parseFloat(AfterRedemptionVal);
		    if (ConvPriceBR != ConvPriceAR + ConvRedemptionValue) {
			messagesMap.put("Expected Target Page", "Selected Burn points is not deducted from the total price");
			status = WARNING;
		    }
		} else {
		    messagesMap.put("Expected Target Page", "Points redemption section was not found");
		    status = WARNING;
		}
	    }

	    if (dataMap.get("PaypalInputFileName") != null && dataMap.get("PaypalInputFileName").size() > 0 && dataMap.get("PaypalSheetName") != null && dataMap.get("PaypalSheetName").size() > 0
		    && dataMap.get("PaypalRowId") != null && dataMap.get("PaypalRowId").size() > 0) {
		payPalUserName = getTestData(dataMap.get("PaypalInputFileName").get(0), dataMap.get("PaypalSheetName").get(0), dataMap.get("PaypalRowId").get(0), "UserName");
		payPalPassWord = getTestData(dataMap.get("PaypalInputFileName").get(0), dataMap.get("PaypalSheetName").get(0), dataMap.get("PaypalRowId").get(0), "Password");
	    }
	    // New piece of code---Guest User--Started
	    if (dataMap.get("GuestPayment") != null) {
		if (dataMap.get("GuestPayment").get(0).equalsIgnoreCase("CreditCard")) {
		    getElementByProperty(Continue_BTN, browser).click();
		    selectByVisibleText(CardType_LST, cardType, browser);
		    clearAndEnterText(CardNumber_TXT, cardNumber, browser);
		    selectByVisibleText(ExpirationMonth_LST, expireMonth, browser);
		    selectByVisibleText(ExpirationYear_LST, expireYear, browser);
		    if (dataMap.get("SameAsShippingAddress").get(0).equalsIgnoreCase("true")) {
			getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		    } else {
			clearAndEnterText(FirstName_TXT, firstName, browser);
			clearAndEnterText(LastName_TXT, lastName, browser);
			clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
			clearAndEnterText(City_TXT, city, browser);
			selectByVisibleText(State_LST, state, browser);
			clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    }
		    getElementByProperty(Continue_BTN, browser).click();
		}
	    }
	    // New piece of code---Guest User--Ended

	    if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("CreditCard")) {
		// Existing Credit Card Option--by default existing credeit card
		// will be selected
		/*
		 * if (isElementPresentVerification(CreditCard_RADIO, browser))
		 * { getElementByProperty(CreditCard_RADIO, browser).click(); }
		 */

		// 18-02-13--Added by SIVA-- Clicking on continue button if
		// Select Payment Method Type header found(SDD)
		if (SDDFlag.equalsIgnoreCase("ON")) {
		    if (isElementPresentVerification(SelectaPaymentMethodTypeHeader_ELM, browser) && !isElementPresentVerification(EditCreditCartInformation_LNK, browser)) {
			if (!isElementPresentVerifyClick(Continue_BTN, browser)) {
			    throw new Exception("Not able to click Continue Button");
			}
		    }
		}
		if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("HomeAddress")) {
		    getElementByProperty(HomeAddress_RADIO, browser).click();
		} else if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("NewBillingAddress")) {
		    getElementByProperty(NewBillingAddress_RADIO, browser).click();
		    if ((dataMap.get("SameAsShippingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		    } else {
			clearAndEnterText(FirstName_TXT, firstName, browser);
			clearAndEnterText(LastName_TXT, lastName, browser);
			clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
			clearAndEnterText(City_TXT, city, browser);
			selectByVisibleText(State_LST, state, browser);
			clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    }
		    if ((dataMap.get("SaveBillingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SaveBillingAdd_CHK, browser).click();
		    }
		}
		if (isElementPresentVerification(Continue_BTN, browser)) {
		    getElementByProperty(Continue_BTN, browser).click();
		}

	    } else if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("NewCreditCard")) {
		// New Credit Card Option

		if (isElementPresentVerification(UpdateCCInformation_LNK, browser)) {
		    getElementByProperty(UpdateCCInformation_LNK, browser).click();
		} else if (!isElementPresentVerification(CardType_LST, browser)) {
		    if (isElementPresentVerification(Continue_BTN, browser)) {
			getElementByProperty(Continue_BTN, browser).click();
		    }
		}
		getElementByProperty(NewCreditCard_RADIO, browser).click();
		selectByVisibleText(CardType_LST, cardType, browser);
		clearAndEnterText(CardNumber_TXT, cardNumber, browser);
		selectByVisibleText(ExpirationMonth_LST, expireMonth, browser);
		selectByVisibleText(ExpirationYear_LST, expireYear, browser);
		if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("HomeAddress")) {
		    getElementByProperty(HomeAddress_RADIO, browser).click();
		} else if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("NewBillingAddress")) {
		    getElementByProperty(NewBillingAddress_RADIO, browser).click();
		    if ((dataMap.get("SameAsShippingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		    } else {
			clearAndEnterText(FirstName_TXT, firstName, browser);
			clearAndEnterText(LastName_TXT, lastName, browser);
			clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
			clearAndEnterText(City_TXT, city, browser);
			selectByVisibleText(State_LST, state, browser);
			clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    }
		    if ((dataMap.get("SaveBillingAddress").get(0)).equalsIgnoreCase("true")) {
			getElementByProperty(SaveBillingAdd_CHK, browser).click();
		    }
		}
		if (isElementPresentVerification(Continue_BTN, browser)) {
		    getElementByProperty(Continue_BTN, browser).click();
		}
	    } else if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("BillMeLater")) {

		// change payment
		if (isElementPresentVerification(ChangePayment_BTN, browser)) {
		    getElementByProperty(ChangePayment_BTN, browser).click();
		}

		// Bill Me Later Option
		getElementByProperty(BillMeLater_RADIO, browser).click();
		if (isElementPresentVerification(Continue_BTN, browser)) {
		    getElementByProperty(Continue_BTN, browser).click();
		}

		if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("HomeAddress"))
		    getElementByProperty(BMLHomeAddress_RADIO, browser).click();
		else if ((dataMap.get("BillingAddress").get(0)).equalsIgnoreCase("NewBillingAddress")) {
		    getElementByProperty(NewBillingAddress_RADIO, browser).click();
		}
		if ((dataMap.get("SameAsShippingAddress").get(0)).equalsIgnoreCase("true")) {
		    getElementByProperty(SameAsShippingAddress_CHK, browser).click();
		} else {
		    clearAndEnterText(FirstName_TXT, firstName, browser);
		    clearAndEnterText(LastName_TXT, lastName, browser);
		    clearAndEnterText(StreetAddress_TXT, streetAddress, browser);
		    clearAndEnterText(City_TXT, city, browser);
		    selectByVisibleText(State_LST, state, browser);
		    clearAndEnterText(ZIPCode_TXT, zipCode, browser);
		    clearAndEnterText(BMLEmailAddress_TXT, emailAddress, browser);
		    clearAndEnterText(BMLPhoneNumber_TXT, phoneNumber, browser);
		}
		if ((dataMap.get("SaveBillingAddress").get(0)).equalsIgnoreCase("true")) {
		    getElementByProperty(SaveBillingAdd_CHK, browser).click();
		}
		if (isElementPresentVerification(BML_IAgree_CHK, browser)) {
		    selectByVisibleText(BML_DOB_MONTH_LST, dobMonth, browser);
		    selectByVisibleText(BML_DOB_DAY_LST, dobDay, browser);
		    selectByVisibleText(BML_DOB_YEAR_LST, dobYear, browser);
		    clearAndEnterText(BML_SSN_TXT, ssn, browser);
		    getElementByProperty(BML_IAgree_CHK, browser).click();
		}
		if (isElementPresentVerification(BMLContinue_BTN, browser)) {
		    getElementByProperty(BMLContinue_BTN, browser).click();
		} else {
		    if (isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
			System.err.println("in optimized checkout page");
		    } else if (!isElementPresentVerifyClick(BML_AgreeandContinue_BTN, browser)) {
			throw new Exception("Not able to Click on Agree And Cotinue Button");
		    }
		}
	    } else if ((dataMap.get("PaymentOption").get(0)).equalsIgnoreCase("PayPal")) {
		// Paypal Option

		if (isElementPresentVerification(ChangePayment_BTN, browser)) {
		    getElementByProperty(ChangePayment_BTN, browser).click();
		}
		getElementByProperty(PayPal_RADIO, browser).click();
		if (isElementPresentVerification(Continue_BTN, browser)) {
		    getElementByProperty(Continue_BTN, browser).click();
		}

		if (isElementPresentVerification(HavePayPalAccount_HEADER, browser)) {
		    clearAndEnterText(PayPal_Username_TXT, payPalUserName, browser);
		    clearAndEnterText(PayPal_Password_TXT, payPalPassWord, browser);
		    getElementByProperty(PayPal_Login_BTN, browser).click();
		    Thread.sleep(5000);
		    getElementByProperty(PayPal_Continue_BTN, browser).click();

		    // Verify Your County page
		    if (isElementPresentVerification(VerifyYourCounty_Heading, browser)) {
			if (!isElementPresentVerifyClick(VerifyCountySelect_BTN, browser)) {
			    throw new Exception("Not able to click on select button in Verify County Page");
			}
		    }

		}
	    }

	    /*
	     * if (isElementPresentVerification(UpdateCCInformation_LNK,
	     * browser)) { getElementByProperty(UpdateCCInformation_LNK,
	     * browser).click(); }
	     */

	    if (isElementPresentVerification(OptimizedCheckout_Heading, browser)) {
		System.err.println("Optimized Checkout page");
	    } else if (!isElementPresentVerification(ReviewOrderAndSubmit_HEADER, browser)) {
		messagesMap.put("Expected Target Page", "Review Order and Submit Page Header was not found");
		status = WARNING;
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

    /**
     ************************************************************************ 
     * @Purpose - Method to Customer selects required option(Submit, change
     *          shipping info, change pickup details,....) from Order Review
     *          Page
     * @Input -
     * @author - Siva
     * @Created - 27 May 2012
     * @Modified By - Madusudanan
     * @Modified Date -18-FEB-2014
     ************************************************************************ 
     */
    public static void selectOptionFromReviewOrderPage(EventFiringWebDriver browser, StepBean stepBean, Map<String, List<String>> dataMap) {
	String status = PASS;
	String ShippingInfo_Change_LNK = "a[title='Change Shipping Information']~CSS";
	String ShippingMethod_Change_LNK = "a[title='Change Shipping Method']~CSS";
	String BillingInfo_Change_LNK = "a[title='Change Billing Information']~CSS";
	String SubmitOrder_BTN = "//input[@id='submitTop' or @alt='Submit Order' or @title='Submit order' or @title = 'Submit Order']~XPATH";
	String ShippingInformation_Header = "//h2[contains(text(),'Shipping Information')]~XPATH";
	String ShipMethod_Header = "//h2[contains(text(),'Ship Method')]~XPATH";
	String paymentInfo_Header = "//h2[contains(text(),'Payment Information')]~XPATH";
	String OrderConfirmation_Message = "//strong[contains(text(),'Thank You! Your order is complete') or contains(text(),'Thank you for shopping at Walgreens') or contains(text(),'Thank You for shopping at Walgreens')]~XPATH";
	String ChangeStoreOrPickupTime = "a[title='Change store or Pickup time']~CSS";
	String PickupLocationPage_Header = "//*[contains(text(),'Pickup Location') or contains(text(),'Pickup details')]~XPATH";
	String WagCoupon_IMG = "img[title*='Print Coupon for your $25 gift card!']~CSS";
	String PSCDetailsDiv_ELM = "//div[contains(@class,'mrgAuto')]~XPATH";
	String TermsAndCondition_CHK = "//input[@id='terms']~XPATH";
	Map<String, String> messagesMap = null;
	try {
	    if (messagesMap == null) {
		messagesMap = new HashMap<String, String>();
		stepBean.setStepStatusMessages(messagesMap);
	    }
	    int totalRowCount = Integer.parseInt(dataMap.get("totalRowCount").get(0));
	    for (int i = 0; i < totalRowCount; i++) {
		if (dataMap.get("SubmitOrder").get(i).equalsIgnoreCase("Yes")) {
		    //Not throwing an exception for Terms and Conditions Checkbox , since functionality is in A/B testing
		    if (isElementPresentVerifyClick(TermsAndCondition_CHK, browser));
		    if (!isElementPresentVerifyClick(SubmitOrder_BTN, browser)) {
			throw new Exception("Not able to Click on Submit Order");
		    }
		    // #SARAVANAN M - June-24-2013 -will wait here to verify the
		    // order confirmation message
		    if (dataMap.containsKey("NewRefillRx")) {
			if (dataMap.get("NewRefillRx").get(0).equalsIgnoreCase("Yes")) {
			    do {
				// do nothing
			    } while (!isElementPresentVerification(OrderConfirmation_Message, browser));
			}
		    } else {
			if (!isElementPresentVerification(OrderConfirmation_Message, browser)) {
			    throw new Exception("Not able to Find the Order Confiramtion Message");
			}
		    }
		}
		if (dataMap.get("ChangeStoreOrPickUpTime").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(ChangeStoreOrPickupTime, browser)) {
			throw new Exception("Not able to click on Change Pickup Store or Pickup time link");
		    }
		    if (!isElementPresentVerification(PickupLocationPage_Header, browser)) {
			messagesMap.put("Pickup Location Page", "Page is not Navigated to Pickup Location Page after clicking ChangeStore link");
			status = WARNING;
		    }
		}
		if (dataMap.get("ChangeShippingInformation").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(ShippingInfo_Change_LNK, browser)) {
			throw new Exception("Not able to click on Shipping Info Change Link");
		    }
		    if (!isElementPresentVerification(ShippingInformation_Header, browser)) {
			messagesMap.put("Shipping INformation Page", "Page is not Navigated to Shipping INformation Page after clicking ChangeShippingInformation link");
			status = WARNING;
		    }
		}
		if (dataMap.get("ChangeShippingMethod").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(ShippingMethod_Change_LNK, browser)) {
			throw new Exception("Not able to click on ChangeShippingMethod Link");
		    }
		    if (!isElementPresentVerification(ShipMethod_Header, browser)) {
			messagesMap.put("Shipping Method Page", "Page is not Navigated to Shipping Method Page after clicking ChangeShippingMethod link");
			status = WARNING;
		    }
		}
		if (dataMap.get("ChangeBillingInformation").get(i).equalsIgnoreCase("Yes")) {
		    if (!isElementPresentVerifyClick(BillingInfo_Change_LNK, browser)) {
			throw new Exception("Not able to click on ChangeBillingInformation Link");
		    }
		    if (!isElementPresentVerification(paymentInfo_Header, browser)) {
			messagesMap.put("Payment Info Page", "Page is not Navigated to Payment Info Page after clicking ChangeBillingInformation link");
			status = WARNING;
		    }
		}

		if (!(dataMap.get("WagCouponVerify") == null)) {
		    if (dataMap.get("WagCouponVerify").get(i).equalsIgnoreCase("Yes")) {
			if (isElementPresentVerification(WagCoupon_IMG, browser)) {
			    messagesMap.put("Wag $25 Coupon for Transfer Rx", "The Coupon is displayed for the Medicare/medicaid user");
			    status = WARNING;
			}
		    }
		}
		if (dataMap.get("VerifyPSCTempID") != null) {
		    if (dataMap.get("VerifyPSCTempID").get(0).equalsIgnoreCase("Yes")) {
			List<WebElement> pTagsinPSCOrderDetailsDiv = getElementByProperty(PSCDetailsDiv_ELM, browser).findElements(By.tagName("p"));
			String PSCTempID = null;
			for (int k = 0; k < pTagsinPSCOrderDetailsDiv.size(); k++) {
			    if (pTagsinPSCOrderDetailsDiv.get(k).getText().contains("Temp ID")) {
				PSCTempID = pTagsinPSCOrderDetailsDiv.get(k + 1).getText();
				break;
			    }
			}
			if (PSCTempID.length() != 12) {
			    messagesMap.put("PSC Temp ID", "Temp ID is not generated or its lenght is not equal to 12");
			    status = WARNING;
			}
		    }
		}
	    }

	} catch (Exception e) {
	    status = FAIL;
	    messagesMap.put("An Exception Occured:", e.getMessage());
	    LogIt(e, null, stepBean);
	} finally {
	    stepBean.setStepStatus(status);
	}
    }

   

}
